---
title: ECMAScript 2016, 2017, å’Œ2018ä¸­æ–°å¢åŠŸèƒ½çš„ç¤ºä¾‹
date: 2018-04-11
copyright: true
author:
  name: sachieyuan
  link: https://github.com/sachieyuan
tag:
- ECMAScript 2016
- ECMAScript 2017
- ECMAScript 2018
---


# ä»¥ä¸‹æ˜¯ECMAScript 2016, 2017, å’Œ2018ä¸­æ–°å¢åŠŸèƒ½çš„ç¤ºä¾‹


[åŸæ–‡é“¾æ¥](https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e)

å¾ˆéš¾è·Ÿè¸ªJavaScript(ECMAScript)ä¸­çš„æ–°åŠŸèƒ½ï¼Œæ›´éš¾æ‰¾åˆ°æœ‰ç”¨çš„ä»£ç ç¤ºä¾‹ã€‚

å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä»‹ç»åœ¨ES2016ï¼ŒES2017å’ŒES2018ï¼ˆæœ€ç»ˆè‰æ¡ˆï¼‰ä¸­æ·»åŠ çš„TC39å·²å®Œæˆææ¡ˆä¸­åˆ—å‡ºçš„æ‰€æœ‰18ä¸ªåŠŸèƒ½ï¼Œå¹¶å‘ä»–ä»¬å±•ç¤ºæœ‰ç”¨çš„ç¤ºä¾‹ã€‚

> è¿™æ˜¯ä¸€ä¸ªç›¸å½“é•¿çš„å¸–å­ï¼Œä½†åº”è¯¥æ˜¯ä¸€ä¸ªç®€å•çš„é˜…è¯»ã€‚æŠŠè¿™çœ‹ä½œæ˜¯â€œNetflix binge readingâ€ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä¿è¯ä½ å°†å¯¹è¿™äº›åŠŸèƒ½æœ‰å¾ˆå¤šçš„äº†è§£ã€‚

è®©æˆ‘ä»¬ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°çœ‹çœ‹ï¼š

<!-- more -->

## ECMAScript 2016

- ### 1. Array.prototype.includes

`includes`æ˜¯æ•°ç»„ä¸Šçš„ç®€å•å®ä¾‹æ–¹æ³•ï¼Œå¹¶æœ‰åŠ©äºè½»æ¾æŸ¥æ‰¾æŸä¸ªé¡¹æ˜¯å¦åœ¨Arrayä¸­ï¼ˆåŒ…æ‹¬`NaN`ä¸åƒ`indexOf`ï¼‰
```js
const arr = [ 1, 2, 3, 4, NaN];

// es2016ä¸ä½¿ç”¨
if(arr.indexOf(3) >= 0){
  console.log(true);
}

//ä½¿ç”¨
if(arr.includes(3)){
  console.log(true);
}

//ps: æ³¨æ„ indexOf æ˜¯ä¸æ”¯æŒæŸ¥æ‰¾NaNçš„
arr.includes(NaN) // true
arr.indexOf(NaN) // -1 (indexOf ä¸æ”¯æŒ NaN)
```
> çäº‹ï¼šäººä»¬æƒ³è¦å‘½åçš„JavaScriptè§„èŒƒ`contains`ï¼Œä½†è¿™æ˜¾ç„¶å·²è¢«Mootoolsä½¿ç”¨ï¼Œå› æ­¤ä»–ä»¬ä½¿ç”¨äº†`includes`ã€‚

- ### 2. æŒ‡æ•°è¿ç®—ç¬¦

æ•°å­¦è¿ç®—å¦‚åŠ æ³•å’Œå‡æ³•åˆ†åˆ«æœ‰ `+` å’Œ `-` ç­‰è¿ç®—ç¬¦ã€‚ä¸ä»–ä»¬ç±»ä¼¼ï¼Œ`**` è¿ç®—ç¬¦é€šå¸¸ç”¨äºæŒ‡æ•°è¿ç®—ã€‚åœ¨ECMAScript 2016ä¸­ï¼Œå¼•å…¥äº† `**` è€Œä¸æ˜¯Math.powã€‚
```js
// ä¸ä½¿ç”¨
Math.pow(7,2) //49

//ä½¿ç”¨
7**2 //49

```

## ECMAScript 2017

- ### 1. Object.values()

`Object.value()`æ˜¯ä¸€ä¸ªä¸`Object.keys()`ç±»ä¼¼çš„æ–°å‡½æ•°ï¼Œä½†ä¼šè¿”å›Objectè‡ªèº«å±æ€§çš„æ‰€æœ‰å€¼ï¼Œæ’é™¤åŸå‹é“¾ä¸­çš„ä»»ä½•å€¼ã€‚

```js
const cars = { 'BMW': 3, 'Tesla': 2, 'Toyota': 1 };

//ES2015
//ES2017 ä¸ä½¿ç”¨
const vals = Object.keys(cars).map(key => cars[key]);
console.log(vals); //[3, 2, 1]


//ES2017 and æœªæ¥
//ä½¿ç”¨
const values = Object.values(cars);
console.log(values); // [3, 2, 1]

```

- ### 2. Object.entries()

`Object.entries()`ä¸`Object.keys`ç›¸å…³ï¼Œä½†ä¸æ˜¯ä»…è¿”å›keysï¼Œè€Œæ˜¯ä»¥æ•°ç»„æ–¹å¼è¿”å›keyså’Œvaluesã€‚è¿™ä½¿å¾—åƒå¾ªç¯ä¸­ä½¿ç”¨å¯¹è±¡æˆ–å°†å¯¹è±¡è½¬æ¢ä¸ºMapsè¿™æ ·çš„äº‹æƒ…å˜å¾—éå¸¸ç®€å•ã€‚

ä¾‹ 1:

```js
const cars = { 'BMW': 3, 'Tesla': 2, 'Toyota': 1 };
// ES5.1
//è€Œä¸æ˜¯æå–é”®ç„¶åå†å¾ªç¯
Object.keys(cars).forEarch(function(key) {
	console.log('key: ' + key + 'value: ' + cars[key]);
})

//ES2017 (ES8)
//ä½¿ç”¨ Object.entries 
for(let [key value] of Object.entries(cars)) {
	console.log(`key: ${key} value: ${value}`);
}

```

ä¾‹ 2:

```js
const cars = { 'BMW': 3, 'Tesla': 2, 'Toyota': 1 };

//ES2015
//ä¸ä½¿ç”¨
//è·å–å¯¹è±¡é”®ï¼Œç„¶åæ·»åŠ æ¯ä¸ªé¡¹ç›®ä»¥åœ¨å¾ªç¯ä¸­æ˜ å°„

const maps = new Map();
Object.keys(cars).forEarch(key => {
	map1.set(key, cars[key]);
})

console.log(map1) // Map { 'BMW' => 3, 'Tesla' => 2, 'Toyota' => 1}

//ES2017 and ä»¥å
//ä½¿ç”¨
const map = new Map(Object.entries(cars));

console.log(map) //Map { 'BMW' => 3, 'Tesla' => 2, 'Toyota' => 1}


```

- ### 3. String padding

å‘å­—ç¬¦ä¸² -- `String.prototype.padStart`å’Œ`String.prototype.padEnd`æ·»åŠ äº†ä¸¤ä¸ªå®ä¾‹æ–¹æ³• -- å®ƒä»¬å…è®¸åœ¨åŸå§‹å­—ç¬¦ä¸²çš„å¼€å§‹æˆ–ç»“å°¾é™„åŠ /é¢„å…ˆæ·»åŠ ç©ºå­—ç¬¦ä¸²æˆ–å…¶ä»–å­—ç¬¦ä¸²ã€‚
```
'someString'.padStart(numberOfCharcters [,stringForPadding]); 
'5'.padStart(10) // '          5'
'5'.padStart(10, '=*') //'=*=*=*=*=5'
'5'.padEnd(10) // '5         '
'5'.padEnd(10, '=*') //'5=*=*=*=*='

```
> å½“æˆ‘ä»¬æƒ³è¦åœ¨è¯¸å¦‚æ¼‚äº®çš„æ‰“å°æ˜¾ç¤ºæˆ–ç»ˆç«¯æ‰“å°ç­‰åœºæ™¯ä¸­å¯¹é½äº‹ç‰©æ—¶ï¼Œè¿™å¾ˆæ–¹ä¾¿ã€‚

- #### 3.1 padStart ä¾‹å­
åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸åŒé•¿åº¦çš„æ•°å­—åˆ—è¡¨ã€‚æˆ‘ä»¬å¸Œæœ›é¢„å…ˆè®¾ç½®â€œ0â€ï¼Œä»¥ä¾¿æ‰€æœ‰é¡¹ç›®å…·æœ‰ç›¸åŒé•¿åº¦çš„10ä½æ•°å­—ç”¨äºæ˜¾ç¤ºç›®çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`padStart(10, '0')`è½»æ¾å®ç°è¿™ä¸€ç‚¹ã€‚

```js
//ES2017
//å¦‚æœä½ æœ‰ä¸€ä¸ªä¸åŒé•¿åº¦çš„é¡¹ç›®åˆ—è¡¨ï¼Œå¹¶å¸Œæœ›æ ¼å¼åŒ–å®ƒä»¬çš„æ˜¾ç¤ºç›®çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨padStart

const formatted = [0, 1, 12, 123, 1234, 12345].map(num => 
	num.toString().padStart(10, '0') // æ·»åŠ  0 ç›´åˆ°é•¿åº¦ä¸º 10
);

console.log(formatted);

//æ‰“å°
// [
// 	'0000000000',
// 	'0000000001',
// 	'0000000012',
// 	'0000000123',
// 	'0000001234',
// 	'0000012345',
// ]

```

- #### 3.2 padEnd ä¾‹å­:

æˆ‘ä»¬æ‰“å°å¤šä¸ªä¸åŒé•¿åº¦çš„é¡¹ç›®å¹¶æƒ³è¦æ­£ç¡®å¯¹é½å®ƒä»¬æ—¶ï¼Œ`padEnd`çœŸçš„å¾ˆæ–¹ä¾¿ã€‚

ä¸‹é¢çš„ä¾‹å­æ˜¯`padEnd`ï¼Œ`padStart`å’ŒO`bject.entries`å¦‚ä½•èšåˆåœ¨ä¸€èµ·äº§ç”Ÿæ¼‚äº®è¾“å‡ºçš„ä¸€ä¸ªå¾ˆå¥½çš„å®ä¾‹ã€‚

```js
const cars = {
  'ğŸš™BMW': '10',
  'ğŸš˜Tesla': '5',
  'ğŸš–Lamborghini': '0'
}
Object.entries(cars).map(([name, count]) => {
  //padEnd appends ' -' until the name becomes 20 characters
  //padStart prepends '0' until the count becomes 3 characters.
  console.log(`${name.padEnd(20, ' -')} Count: ${count.padStart(3, '0')}`)
});
//æ‰“å°ç»“æœ..
// ğŸš™BMW - - - - - - -  Count: 010
// ğŸš˜Tesla - - - - - -  Count: 005
// ğŸš–Lamborghini - - -  Count: 000

```

 - #### 3.3 âš ï¸ Emojis(è¡¨æƒ…ç¬¦å·)å’Œå…¶ä»–åŒå­—èŠ‚å­—ç¬¦ä¸Šçš„padStartå’ŒpadEnd

Emojiså’Œå…¶ä»–åŒå­—èŠ‚å­—ç¬¦ä½¿ç”¨unicodeçš„å¤šä¸ªå­—èŠ‚è¡¨ç¤ºã€‚æ‰€ä»¥`padStart`å’Œ`padEnd`å¯èƒ½æ— æ³•æŒ‰é¢„æœŸå·¥ä½œï¼âš ï¸

ä¾‹å¦‚ï¼šå‡è®¾æˆ‘ä»¬æ­£åœ¨å°è¯•ç”¨â¤ï¸è¡¨æƒ…ç¬¦å·å¡«å……å­—ç¬¦ä¸²`heart`ä»¥è¾¾åˆ°10ä¸ªå­—ç¬¦ã€‚ç»“æœå¦‚ä¸‹æ‰€ç¤º

```js
//æ³¨æ„ï¼Œä¸æ˜¯5é¢—å¿ƒï¼Œåªæœ‰2é¢—å¿ƒå’Œ1é¢—çœ‹èµ·æ¥å¾ˆå¥‡æ€ªçš„å¿ƒï¼

'heart'.padStart(10, "â¤ï¸"); // prints.. 'â¤ï¸â¤ï¸â¤heart'
```

è¿™æ˜¯å› ä¸ºâ¤ï¸é•¿2ä¸ªå­—ç¬¦(`'\u2764\uFE0F'`)!å•è¯heartæœ¬èº«æ˜¯5ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åªå‰©ä¸‹5ä¸ªå­—ç¬¦ã€‚æ‰€ä»¥,JS å¡«å¡ä¸¤é¢—å¿ƒç”¨`'\u2764\uFE0F'`å’Œç”Ÿäº§â¤ï¸â¤ï¸ã€‚ä¸ºæœ€åä¸€ä¸ªåªæ˜¯ç”¨å¿ƒçµçš„ç¬¬ä¸€ä¸ªå­—èŠ‚`\ u2764`äº§ç”Ÿâ¤

æ‰€ä»¥ç»“æœæ˜¯: `â¤ï¸â¤ï¸â¤heart`

> PSï¼šæ‚¨å¯ä»¥ä½¿ç”¨[æ­¤é“¾æ¥](https://encoder.internetwache.org/#tab_uni) æŸ¥çœ‹unicodeå­—ç¬¦è½¬æ¢

- ### 4. Object.getOwnPropertyDescriptors

æ­¤æ–¹æ³•è¿”å›ç»™å®šå¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯(åŒ…æ‹¬ `get` `set` æ–¹æ³•). æ·»åŠ è¿™ä¸ªçš„ä¸»è¦åŠ¨æœºæ˜¯å…è®¸æµ…æ‹·è´/å…‹éš†ä¸€ä¸ªå¯¹è±¡åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿæ‹·è´getterå’Œsetterå‡½æ•°ï¼Œè€Œä¸æ˜¯`Object.assign`

**Object.assignæµ…å…‹éš†é™¤åŸå§‹æºå¯¹è±¡çš„getterå’Œsetterå‡½æ•°ä»¥å¤–çš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ã€‚**


ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†`Object.assign`å’Œ`Object.getOwnPropertyDescriptors`ä¸`Object.defineProperties`ä¹‹é—´çš„åŒºåˆ«ï¼Œä»¥å°†åŸå§‹å¯¹è±¡`Car`å¤åˆ¶åˆ°æ–°å¯¹è±¡`ElectricCar`ï¼Œ`Object.getOwnPropertyDescriptors`çœ‹åˆ°ï¼Œ`discount` è·å–å™¨å’Œè®¾ç½®å™¨å‡½æ•°ä¹Ÿè¢«å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­ã€‚

######ä¹‹å‰...

```js
//ä¹‹å‰...
var Car = {
	name: 'BMW',
	price: 1000000,
	set discount(x) {
		this.d = x;
	},
	get discount() {
		return this.d;
	},
};

//æ‰“å°Carå¯¹è±¡çš„â€œdiscountâ€å±æ€§çš„è¯¦ç»†ä¿¡æ¯
console.log(Object.getOwnPropertyDescriptor(Car, 'discount'));
//æ‰“å°ç»“æœ..
// {
// 	get: [Function: get],
// 	set: [Function: set],
// 	enumerable: true,
// 	configurable: true
// }

//ä½¿ç”¨Object.assignå°†Carçš„å±æ€§å¤åˆ¶åˆ°ElectricCar
const ElectricCar = Object.assign({}, Car)ï¼›

//æ‰“å°ElectricCarå¯¹è±¡çš„â€œdiscountâ€å±æ€§çš„è¯¦ç»†ä¿¡æ¯
console.log(Object.getOwnPropertyDescriptor(ElectricCar, 'discount'));

//æ‰“å°
// {
// 	value: undefined,
// 	writable: true,
// 	enumerable: true,
// 	configurable: true
// }

//âš ï¸ è¯·æ³¨æ„ElectricCarå¯¹è±¡ä¸­çš„â€œdiscountâ€å±æ€§ä¸­ç¼ºå°‘getterå’Œsetterï¼ğŸ‘ğŸ‘
```
######ä»¥å...

```js
//ä»¥å...
var Car = {
	name: 'BMW',
	price: 1000000,
	set discount(x) {
		this.d = x;
	},
	get discount() {
		return this.d;
	},
};
//ä½¿ç”¨Object.definePropertieså°†Carçš„å±æ€§å¤åˆ¶åˆ°ElectricCar2
//å¹¶ä½¿ç”¨Object.getOwnPropertyDescriptorsæå–Carçš„å±æ€§

const ElectricCar2 = Object.defineProperties({}, Object.getOwnPropertyDescriptors(Car));
//æ‰“å°ElectricCar2å¯¹è±¡â€œdiscountâ€å±æ€§çš„è¯¦ç»†ä¿¡æ¯
console.log(Object.getOwnPropertyDescriptor(ElectricCar2, 'discount'));
//prints..
// { get: [Function: get],  ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼
//   set: [Function: set],  ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼ğŸ‘ˆğŸ¼
//   enumerable: true,
//   configurable: true 
// }
// è¯·æ³¨æ„ï¼Œgetterå’Œsetterå­˜åœ¨äºElectricCar2å¯¹è±¡ä¸­ï¼Œç”¨äº'discount'å±æ€§ï¼

```

- ### 5. åœ¨å‡½æ•°å‚æ•°ä¸­æ·»åŠ å°¾éšé€—å·(Add trailing commas in the function parameters)

è¿™æ˜¯ä¸€ä¸ªå°çš„æ›´æ–°ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨æœ€åä¸€ä¸ªå‡½æ•°å‚æ•°åé¢åŠ ä¸Šå°¾éšé€—å·ã€‚ä¸ºä»€ä¹ˆï¼Ÿä¸ºäº†å¸®åŠ©åƒgitè¿™æ ·çš„å·¥å…·ï¼Œåªä¼šè®©æ–°å¼€å‘äººå‘˜å—åˆ°æŒ‡è´£ã€‚

ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ:

```js
//é—®é¢˜

//	#1 å¼€å‘è€…åˆ›å»º
function Person(
	name, 
	age
	) {
		this.name = name;
		this.age = age;
}

//#2 å¼€å‘è€…æ·»åŠ address 
function Person(
	name,
	age, // æ·»åŠ å°¾éšé€—å· 	<--------å› ä¸ºé€—å·ï¼Œå¼€å‘äººå‘˜ä¼šè¢«gitç­‰å·¥å…·æ‰€è­¦å‘Š
	address //æ·»åŠ æ–°çš„å‚æ•°
  ) {
		this.name = name;
		this.age = age;
		this.address = address; //æ·»åŠ çš„è¿™è¡Œ
}

//ES2017 è§£å†³
//å…è®¸#1å¼€å‘è€…æ·»åŠ å°¾éšé€—å·
//#1 åˆ›å»ºå¦‚ä¸‹
function Person(
	name, 
	ange,  //<------- ç”±äºå°¾éšé€—å·ï¼Œ#2å¼€å‘è€…ä¸éœ€è¦æ”¹å˜è¿™è¡Œ
	) {
		this.name = name;
		this.age = age;
}
```

>æ³¨æ„ï¼šæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å°¾éšé€—å·æ¥è°ƒç”¨å‡½æ•°


- ### 6. Async/Await

å¦‚æœä½ é—®æˆ‘ï¼Œè¿™æ˜¯è¿„ä»Šä¸ºæ­¢æœ€é‡è¦ä¹Ÿæ˜¯æœ€æœ‰ç”¨çš„åŠŸèƒ½ã€‚å¼‚æ­¥å‡½æ•°(Async)å…è®¸æˆ‘ä»¬ä¸å¤„ç†è°ƒç”¨åœ°ç‹±ï¼Œå¹¶ä½¿æ•´ä¸ªä»£ç çœ‹èµ·æ¥å¾ˆç®€å•ã€‚


`async`å…³é”®å­—å‘Šè¯‰JavaScriptç¼–è¯‘å™¨ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†å‡½æ•°,ç¼–è¯‘å™¨åœ¨è¯¥å‡½æ•°å†…åˆ°è¾¾`await`å…³é”®å­—æ—¶æš‚åœã€‚å®ƒå‡è®¾åœ¨`await`ä¹‹åçš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªæ‰¿è¯ºï¼Œå¹¶ç­‰å¾…æ‰¿è¯ºè§£å†³æˆ–æ‹’ç»åç»§ç»­å‰è¿›.

åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ`getAmount`å‡½æ•°è°ƒç”¨ä¸¤ä¸ªå¼‚æ­¥å‡½æ•°`getUser`å’Œ`getBankBalance`ã€‚æˆ‘ä»¬å¯ä»¥æ‰¿è¯ºåšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†ä½¿ç”¨`async await`æ›´ä¼˜é›…å’Œç®€å•

```js
//ä¸ä½¿ç”¨
// ES2015 Promise

function getAmount(userId) {
	getUser(userId)
		.then(getBankBalance)
		.then(amount => {
			console.log(amount);
		});
}

//ä½¿ç”¨...
// ES2017

async function getAmount2(userId) {
	var user = await getUser(userId);
	var amount = await getBankBalance(user);
	console.log(amount);
}

getAmount('1'); //$1,000

getAmount2('1'); //$1,000

function getUser(userId) {
	return new Promise(resolve => {
		setTimeout(() => {
			resolve('john')
		}, 1000)
	});
}

function getBankBalance(user) {
	return new Promise((resolve, reject) => {
		setTimeout(() => {
			if(user == 'john') {
				resolve('$1,000');
			} else {
				reject(unknown user);
			}
		}, 1000)
	});
}
```

- #### 6.1 å¼‚æ­¥å‡½æ•°æœ¬èº«è¿”å›ä¸€ä¸ªPromise(Async functions themselves return a Promise.)

å¦‚æœæ‚¨æ­£åœ¨ç­‰å¾…å¼‚æ­¥å‡½æ•°çš„ç»“æœï¼Œåˆ™éœ€è¦ä½¿ç”¨Promiseçš„`then`è¯­æ³•æ¥æ•è·å…¶ç»“æœã€‚

åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³ä½¿ç”¨c`onsole.log`è®°å½•ç»“æœï¼Œä½†ä¸æ˜¯åœ¨doubleAndAddä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬æƒ³ç­‰å¾…å¹¶ä½¿ç”¨`then`è¯­æ³•å°†ç»“æœä¼ é€’ç»™`console.log`.

```js

//å¼‚æ­¥å‡½æ•°æœ¬èº«è¿”å›ä¸€ä¸ªPromise
async function doubleAndAdd(a, b) {
	a = await doubleAfterlSec(a);
	b = await doubleAfterlSec(b);
	return a + b;
}

//ç”¨æ³•
doubleAndAdd(1, 2).then(console.log);

function doubleAfterlSec(param) {
	return new Promise (resolve => {
		setTimeout(resolve(param * 2), 1000);
	});
}

```

- #### 6.2 å¹¶è¡Œè°ƒç”¨å¼‚æ­¥/ç­‰å¾…(Calling async/await in parallel)

åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ç­‰å¾…ä¸¤æ¬¡ï¼Œä½†æ¯æ¬¡æˆ‘ä»¬ç­‰å¾…ä¸€ç§’ï¼ˆæ€»å…±2ç§’ï¼‰ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒå¹¶è¡Œï¼Œå› ä¸º`a`å’Œ`b`ä¸ä¾èµ–äºä½¿ç”¨`Promise.all`çš„å…¶ä»–å¯¹è±¡ã€‚

```js
//å¼‚æ­¥å‡½æ•°æœ¬èº«è¿”å›ä¸€ä¸ªPromise
async function doubleAndAdd(a, b) {
	//æ³¨æ„ï¼šè¿™è¾¹ä½¿ç”¨ Promise.all
	//æ³¨æ„åˆ°ä½¿ç”¨æ•°ç»„è§£æ„,æ•è·ç»“æœ
	[a, b] = await Promise.all([doubleAfterlSec(a), doubleAfterlSec(b)]);
	return a + b;
}

//ç”¨æ³•
doubleAndAdd(1, 2).then(console.log);

function doubleAfterlSec(param) {
	return new Promise (resolve => {
		setTimeout(resolve(param * 2), 1000);
	});
}
```
- #### 6.3 å¼‚æ­¥/ç­‰å¾…å‡½æ•°æ—¶çš„é”™è¯¯å¤„ç†(Error handling async/await functions
)

ä¸‹é¢ä½¿ç”¨å¼‚æ­¥ç­‰å¾…æ—¶æœ‰å„ç§æ–¹æ³•æ¥å¤„ç†é”™è¯¯ã€‚

> Option 1 - åœ¨å‡½æ•°ä¸­ä½¿ç”¨try catch

```js
// 1. ä½¿ç”¨ try catch 

async function doubleAndAdd(a, b) {
	try {
		a = await doubleAfterlSec(a);
		b = await doubleAfterlSec(b);
	} catch (e) {
		return NaN; // return something
	}
	return a + b;
}

// ç”¨æ³• 
doubleAndAdd('one', 2).then(console.log) //NaN
doubleAndAdd(1, 2).then(console.log) // 6

function doubleAfterlSec(param) {
	return new Promise((resolve, reject) => {
		setTimeout(function() {
			let val = param * 2;
			isNaN(val) > reject(NaN) : resolve(val);
		}, 1000);
	});
}
```

> Option 2 â€” catch è·æ¯ä¸ªç­‰å¾…è¡¨è¾¾å¼ï¼ˆCatch every await expressionï¼‰

ç”±äºæ¯ä¸ª`await`è¡¨è¾¾å¼éƒ½ä¼šè¿”å›`Promise`ï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨æ¯è¡Œä¸Šæ•è·é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```js
//Option 2 - *Catch* æ¯ä¸ªç­‰å¾…çº¿ä¸Šçš„é”™è¯¯
//å› ä¸ºæ¯ä¸ªç­‰å¾…è¡¨è¾¾æœ¬èº«å°±æ˜¯ä¸€ä¸ªPromise
async function doubleAndAdd(a, b) {
	a = await doubleAfter1Sec(a).catch(e => console.log('"a" is NaN')); // ğŸ‘ˆ
  b = await doubleAfter1Sec(b).catch(e => console.log('"b" is NaN')); // ğŸ‘ˆ
  if (!a || !b) {
  	return NaN;
  }
	return a + b;
}
//ç”¨æ³•:
doubleAndAdd('one', 2).then(console.log); // NaN  and logs:  "a" is NaN
doubleAndAdd(1, 2).then(console.log); // 6
function doubleAfter1Sec(param) {
	return new Promise((resolve, reject) => {
		setTimeout(function() {
			let val = param * 2;
			isNaN(val) ? reject(NaN) : resolve(val);
		}, 1000);
	});
}


```

> Option 3â€Šâ€”â€Šæ•è·æ•´ä¸ªå¼‚æ­¥ç­‰å¾…å‡½æ•°ï¼ˆCatch the entire async-await functionï¼‰

```js
//Option 3 - ä¸è¦åšä»»ä½•äº‹æƒ…ï¼Œåœ¨functionå¤–æ•è·
//å› ä¸ºå¼‚æ­¥/ç­‰å¾…è¿”å›ä¸€ä¸ªPromiseï¼Œæˆ‘ä»¬å¯ä»¥æ•æ‰æ•´ä¸ªå‡½æ•°çš„é”™è¯¯
async function doubleAndAdd(a, b) {
 a = await doubleAfter1Sec(a);
 b = await doubleAfter1Sec(b);
 return a + b;
}
//ç”¨æ³•
doubleAndAdd('one', 2)
.then(console.log)
.catch(console.log); // ğŸ‘ˆğŸ‘ˆğŸ¼<------- use "catch"
function doubleAfter1Sec(param) {
 return new Promise((resolve, reject) => {
  setTimeout(function() {
   let val = param * 2;
   isNaN(val) ? reject(NaN) : resolve(val);
  }, 1000);
 });
}
```

## ECMAScript 2018

>ECMAScriptç›®å‰å¤„äºæœ€ç»ˆè‰æ¡ˆä¸­ï¼Œå°†äº2018å¹´6æœˆæˆ–7æœˆå‘å¸ƒã€‚ä»¥ä¸‹æ‰€æœ‰åŠŸèƒ½å‡åœ¨Stage-4ä¸­ï¼Œå¹¶å°†æˆä¸ºECMAScript 2018çš„ä¸€éƒ¨åˆ†

- ###  1. å…±äº«å†…å­˜å’ŒåŸå­ ([Shared memory and atomics](https://github.com/tc39/ecmascript_sharedme))
è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„ï¼Œéå¸¸å…ˆè¿›çš„åŠŸèƒ½ï¼Œæ˜¯å¯¹JSå¼•æ“çš„æ ¸å¿ƒå¢å¼ºã€‚

ä¸»è¦æ€æƒ³æ˜¯ä¸ºJavaScriptæä¾›æŸç§å¤šçº¿ç¨‹åŠŸèƒ½ï¼Œä»¥ä¾¿JSå¼€å‘äººå‘˜å¯ä»¥ç¼–å†™é«˜æ€§èƒ½ï¼Œé€šè¿‡å…è®¸è‡ªå·±ç®¡ç†å†…å­˜è€Œä¸æ˜¯è®©JSå¼•æ“ç®¡ç†å†…å­˜æ¥å®ç°å¹¶å‘ç¨‹åºã€‚

è¿™æ˜¯é€šè¿‡ä¸€ç§åä¸º[SharedArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer)çš„æ–°å‹å…¨å±€å¯¹è±¡æ¥å®Œæˆçš„ï¼Œå®ƒåŸºæœ¬ä¸Šå°†æ•°æ®å­˜å‚¨åœ¨å…±äº«å†…å­˜ç©ºé—´ä¸­.æ‰€ä»¥è¿™ä¸ªæ•°æ®å¯ä»¥åœ¨ä¸»JSçº¿ç¨‹å’Œç½‘ç»œå·¥ä½œè€…çº¿ç¨‹ä¹‹é—´å…±äº«ã€‚

åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ä¸»JSçº¿ç¨‹å’ŒWebå·¥ä½œè€…ä¹‹é—´å…±äº«æ•°æ®ï¼Œæˆ‘ä»¬å¿…é¡»å¤åˆ¶æ•°æ®å¹¶ä½¿ç”¨`postMessage`å°†å…¶å‘é€åˆ°å…¶ä»–çº¿ç¨‹ã€‚å°±è¿™æ ·å­!

æ‚¨åªéœ€ä½¿ç”¨`SharedArrayBuffer`ï¼Œä¸»çº¿ç¨‹å’Œå¤šä¸ªWebå·¥ä½œçº¿ç¨‹å³å¯è®¿é—®æ•°æ®ã€‚

ä½†åœ¨çº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜å¯èƒ½ä¼šå¯¼è‡´ç«äº‰çŠ¶å†µã€‚ä¸ºäº†é¿å…ç«äº‰æ¡ä»¶ï¼Œå¼•å…¥äº†â€œ[Atomics](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Atomics)â€å…¨å±€å¯¹è±¡ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ä½¿ç”¨å®ƒçš„æ•°æ®æ—¶ï¼Œ`Atomics`æä¾›äº†å„ç§æ–¹æ³•æ¥é”å®šå…±äº«å†…å­˜ã€‚å®ƒè¿˜æä¾›äº†å®‰å…¨åœ°æ›´æ–°å…±äº«å†…å­˜ä¸­çš„æ•°æ®çš„æ–¹æ³•ã€‚

> å»ºè®®é€šè¿‡æŸä¸ªåº“ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œä½†ç°åœ¨æ²¡æœ‰æ„å»ºåœ¨æ­¤åŠŸèƒ½ä¹‹ä¸Šçš„åº“ã€‚

å¦‚æœæ‚¨æœ‰å…´è¶£ï¼Œæ¨èé˜…è¯»ï¼š

1. [From Workers to Shared Memory](http://lucasfcosta.com/2017/04/30/JavaScript-From-Workers-to-Shared-Memory.html)â€Šâ€”â€Šlucasfcosta
2. [A cartoon intro to SharedArrayBuffers](https://hacks.mozilla.org/category/code-cartoons/a-cartoon-intro-to-sharedarraybuffers/)â€Šâ€”â€ŠLin Clark
3. [Shared memory and atomics](http://2ality.com/2017/01/shared-array-buffer.html)â€Šâ€”â€ŠDr. Axel Rauschmayer


- ### 2. æ ‡è®°æ¨¡æ¿å­—é¢é™åˆ¶å·²åˆ é™¤ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²ï¼‰

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ¾„æ¸…ä¸€ä¸‹â€œTagged Template literalâ€æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°ç†è§£è¿™ä¸ªç‰¹æ€§ã€‚

åœ¨ES2015+ä¸­ï¼Œæœ‰ä¸€é¡¹ç§°ä¸ºæ ‡è®°æ¨¡æ¿æ–‡å­—çš„åŠŸèƒ½ï¼Œå…è®¸å¼€å‘äººå‘˜è‡ªå®šä¹‰å¦‚ä½•æ’å…¥å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œä»¥æ ‡å‡†æ–¹å¼æ’å…¥å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹æ‰€ç¤º

```js
//æ ‡å‡†å­—ç¬¦ä¸²æ’å€¼ 
const firstName = 'Raja';
const greetings = `Hello ${firstName}!`;
console.log(greetings); // "Hello Raja!"
```

åœ¨æ ‡è®°å­—é¢é‡ä¸­ï¼Œå¯ä»¥ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æ¥æ”¶å­—ç¬¦ä¸²æ–‡å­—çš„ç¡¬ç¼–ç éƒ¨åˆ†ï¼Œä¾‹å¦‚`['Hello'ï¼Œ'ï¼']`å’Œæ›¿æ¢å˜é‡ï¼Œä¾‹å¦‚[`'Raja']`ï¼Œä½œä¸ºå‚æ•°å†™å…¥è‡ªå®šä¹‰å‡½æ•°ï¼ˆä¾‹å¦‚`greet`ï¼‰ï¼Œç„¶åä»è¯¥è‡ªå®šä¹‰å‡½æ•°ä¸­è¿”å›æ‰€éœ€çš„ä»»ä½•å†…å®¹ã€‚

ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºæˆ‘ä»¬çš„è‡ªå®šä¹‰â€œTagâ€å‡½æ•°`greet`â€œGood Morningï¼â€ï¼Œâ€œGood afternoon,â€ç­‰æ—¥å­çš„æ—¶é—´ï¼Œä¾æ­¤ç±»æ¨ï¼Œå–å†³äºå­—ç¬¦ä¸²æ–‡å­—çš„ä¸€å¤©ä¸­çš„æ—¶é—´ï¼Œå¹¶è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰å­—ç¬¦ä¸²ã€‚

```js
// "æ ‡è®°â€å‡½æ•°è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰å­—ç¬¦ä¸²æ–‡å­—.
// åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œgreetè°ƒç”¨timeGreetï¼ˆï¼‰æ¥è¿½åŠ Good
// Morning/Afternoon/Evening è§†å½“å¤©çš„æ—¶é—´è€Œå®š.
function greet(hardCodedPartsArray, ...replacementPartsArray) {
 console.log(hardCodedPartsArray); //[ 'Hello ', '!' ]
 console.log(replacementPartsArray); //[ 'Raja' ]
let str = '';
 hardCodedPartsArray.forEach((string, i) => {
  if (i < replacementPartsArray.length) {
   str += `${string} ${replacementPartsArray[i] || ''}`;
  } else {
   str += `${string} ${timeGreet()}`; //<-- æ’å…¥ Good morning/afternoon/evening here
  }
 });
 return str;
}

//ç”¨æ³•
const firstName = 'Raja';
const greetings = greet`Hello ${firstName}!`; //ğŸ‘ˆğŸ¼<-- æ ‡è®°æ–‡å­—
console.log(greetings); //'Hello  Raja! Good Morning!' ğŸ”¥
function timeGreet() {
 const hr = new Date().getHours();
 return hr < 12
  ? 'Good Morning!'
  : hr < 18 ? 'Good Afternoon!' : 'Good Evening!';
}
```

ç°åœ¨æˆ‘ä»¬å·²ç»è®¨è®ºäº†â€œæ ‡è®°â€åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œè®¸å¤šäººæƒ³è¦åœ¨ä¸åŒçš„åŸŸä¸­ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨å‘½ä»¤å’ŒHTTPè¯·æ±‚æ¥ç¼–å†™URIç­‰ç­‰ã€‚

âš ï¸ æ ‡è®°å­—ç¬¦ä¸²æ–‡å­—çš„é—®é¢˜

é—®é¢˜æ˜¯ES2015å’ŒES2016è§„èŒƒä¸å…è®¸ä½¿ç”¨â€œ`\u`â€ï¼ˆunicodeï¼‰ï¼Œâ€œ`\x`â€ï¼ˆåå…­è¿›åˆ¶ï¼‰ç­‰è½¬ä¹‰å­—ç¬¦ï¼Œé™¤éå®ƒä»¬çœ‹èµ·æ¥å®Œå…¨åƒ`\u00A9`æˆ–`\uA9A`æˆ–`\xA9`ã€‚

å› æ­¤ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªå†…éƒ¨ä½¿ç”¨å…¶ä»–åŸŸè§„åˆ™ï¼ˆå¦‚ç»ˆç«¯è§„åˆ™ï¼‰çš„Taggedå‡½æ•°ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦ä½¿ç”¨**\ubla123abla**ï¼Œå®ƒçœ‹èµ·æ¥ä¸åƒ`\u0049`æˆ–`\u{@F804}`ï¼Œé‚£ä¹ˆæ‚¨å°†å¾—åˆ°è¯­æ³•é”™è¯¯ã€‚

åœ¨ES2018ä¸­ï¼Œåªè¦æ ‡è®°å‡½æ•°è¿”å›å…·æœ‰â€œcookedâ€å±æ€§ï¼ˆå…¶ä¸­æ— æ•ˆå­—ç¬¦ä¸ºâ€œundefinedâ€ï¼‰çš„å¯¹è±¡ä¸­çš„å€¼ï¼Œç„¶åå°†â€œrawâ€å±æ€§ï¼ˆä¸ä»»ä½•ä½ æƒ³è¦çš„ï¼‰ã€‚

```js

function myTagFunc(str) { 
 return { "cooked": "undefined", "raw": str.raw[0] }
} 

var str = myTagFunc `hi \ubla123abla`; //è°ƒç”¨ myTagFunc

str // { cooked: "undefined", raw: "hi \\unicode" }
```
- ### 3. æ­£åˆ™è¡¨è¾¾å¼çš„â€œdotallâ€æ ‡å¿—

ç›®å‰åœ¨æ­£åˆ™ä¸­ï¼Œè™½ç„¶dotï¼ˆâ€œ.â€ï¼‰åº”è¯¥åŒ¹é…å•ä¸ªå­—ç¬¦ï¼Œä½†å®ƒä¸åŒ¹é…åƒ`\n \r \f`ç­‰æ–°è¡Œå­—ç¬¦ã€‚

æ¯”å¦‚ï¼š
```js
//ä¹‹å‰
/first.second/.test('first\nsecond'); //false
```

æ­¤å¢å¼ºåŠŸèƒ½ä½¿ç‚¹è¿ç®—ç¬¦å¯ä»¥åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚ä¸ºäº†ç¡®ä¿è¿™ä¸ä¼šç ´åä»»ä½•å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºæ­£åˆ™æ—¶ä½¿ç”¨`\s`æ ‡å¿—ä»¥ä½¿å…¶æ­£å¸¸å·¥ä½œã€‚

```js
//ECMAScript 2018
/first.second/s.test('first\nsecond'); //true   Notice: /s ğŸ‘ˆğŸ¼
```

ä»¥ä¸‹æ˜¯[ææ¡ˆ](https://github.com/tc39/proposal-regexp-dotall-flag)æ–‡æ¡£ä¸­çš„æ•´ä½“APIï¼š

```js
const re = /foo.bar/s;
//æˆ–è€… const re = new RegExp('foo.bar', 's');

re.test('f00\nbar'); //true
re.dotAll // true
re.flags // 's'

```

- ### 4. RegExpå‘½åç»„æ•è·(RegExp Named Group Captures ğŸ”¥)

è¿™ç§å¢å¼ºåŠŸèƒ½ä¸ºå…¶ä»–è¯­è¨€ï¼ˆå¦‚Pythonï¼ŒJavaç­‰ï¼‰æä¾›äº†æœ‰ç”¨çš„RegExpåŠŸèƒ½ï¼Œç§°ä¸ºâ€œå‘½åç»„â€ã€‚è¯¥åŠŸèƒ½å…è®¸å¼€å‘äººå‘˜ç¼–å†™RegExpä»¥ä¸åŒéƒ¨åˆ†çš„æ ¼å¼ï¼ˆ?<name> ...ï¼‰æä¾›åç§°ï¼ˆæ ‡è¯†ç¬¦ï¼‰çš„RegExpä¸­çš„ç»„ã€‚ç„¶åï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨è¯¥åç§°è½»æ¾è·å–ä»–ä»¬éœ€è¦çš„ä»»ä½•ç¾¤ç»„ã€‚

- #### 4.1 åŸºæœ¬å‘½åç»„çš„ä¾‹å­
åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨`(?<year>) (?<month>) and (?year)`åç§°å¯¹æ—¥æœŸRegExçš„ä¸åŒéƒ¨åˆ†è¿›è¡Œåˆ†ç»„ã€‚ç»“æœå¯¹è±¡ç°åœ¨å°†åŒ…å«å…·æœ‰å±æ€§`year`ï¼Œ`month`å’Œ`year`çš„å…·æœ‰ç›¸åº”å€¼çš„`groups`å±æ€§ã€‚

```js
//ä¹‹å‰
let re1 = /(\d{4})-(\d{2})-(\d{2})/;
let result1 = re1.exec('2015-01-02');
console.log(result1);
//
//["2015-01-02", "2015", "01", "02", index: 0, input: "2015-01-02", groups: undefined]

//ä»¥åï¼ˆES2018ï¼‰
let re2 = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/u;
let result2 = re2.exec('2015-01-02');
console.log(result2);
//["2015-01-02", "2015", "01", "02", index: 0, input: "2015-01-02", groups: { year: '2015', month: '01', day: '02'}]


//ç”¨æ³•ï¼š
//ä½ æƒ³è¦çŸ¥é“å¹´ä»½ï¼Œä½ å¯ä»¥ï¼š

console.log(result2.groups.year) //2015


```

- #### 4.2 åœ¨æ­£åˆ™è¡¨è¾¾å¼æœ¬èº«å†…ä½¿ç”¨å‘½åç»„

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `\k<group name>` æ ¼å¼åœ¨æ­£åˆ™è¡¨è¾¾å¼æœ¬èº«ä¸­åå‘å¼•ç”¨è¯¥ç»„ã€‚ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å®ƒçš„å·¥ä½œåŸç†ã€‚

```js
//ä¸‹é¢ä¾‹å­ï¼Œæœ‰ä¸ªç»„å«â€œfruitâ€
//å®ƒæ—¢èƒ½åŒ¹é…â€œappleâ€åˆèƒ½åŒ¹é…â€œorangeâ€.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œ\k<group name>â€æ¥å›å¼•ç”¨è¿™ä¸ªç»„çš„ç»“æœ,(\k<fruit>)
//æ‰€ä»¥å®ƒåŒ¹é…==ä¸¤ä¾§çš„åŒä¸€ä¸ªå•è¯
let sameWords = /(?<fruit>apple|orange)==\k<fruit>/u;

sameWords.test('apple==apple');  //true
sameWords.test('orange==orange');  //true
sameWords.test('apple==orange');  //false

```

- #### 4.3 åœ¨String.prototype.replaceä¸­ä½¿ç”¨å‘½åç»„

ç°åœ¨ï¼Œå·²å‘½åçš„ç»„åŠŸèƒ½è¢«çƒ˜ç„™åˆ°Stringçš„`replace`å®ä¾‹æ–¹æ³•ä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°äº¤æ¢å­—ç¬¦ä¸²ä¸­çš„å•è¯ã€‚

ä¾‹å¦‚ï¼Œæ›´æ”¹â€œfirstName, lastNameâ€ ==> â€œlastName, firstNameâ€

```js
// æ›´æ¢â€œfirstName, lastNameâ€ ==> â€œlastName, firstNameâ€

let re = /(?<firstName>[A-Za-z]+) (?<lastName>[A-Za-z]+$)/u;

'Raja Rao'.replace(re, '$<lastName>, $<firstName>'); // "Rao, Raja"

```

- ###  5. å¯¹è±¡çš„å…¶ä½™å±æ€§(Rest properties for Objects)

restè¿ç®—ç¬¦ `...`ï¼ˆä¸‰ä¸ªç‚¹ï¼‰å…è®¸æˆ‘ä»¬æå–å°šæœªæå–çš„å¯¹è±¡å±æ€§ã€‚

- #### 5.1 ä½ å¯ä»¥ä½¿ç”¨restæ¥å¸®åŠ©åªæå–ä½ æƒ³è¦çš„å±æ€§

```js
// æå– firstName å’Œ age
// å°†å…¶ä½™çš„é¡¹å­˜å‚¨åœ¨â€œremainingâ€å˜é‡ä¸­ã€‚

let { fristName, age, ...remaining } = {
	fristName: 'john',
	lastName: 'smith',
	age: 20,
	height: '5.10',
	race: 'martian',
};
firstName; //john
age //20
remaining //{ lastName: 'smith', height: '5.10', race: 'martian' }

```

- ####  5.2 æ›´å¥½çš„æ˜¯ï¼Œä½ å¯ä»¥åˆ é™¤ä¸éœ€è¦çš„ï¼ğŸ”¥ğŸ”¥

```js
//å‡è®¾æˆ‘ä»¬æƒ³è¦ç§»é™¤SSNï¼Œæˆ‘ä»¬ä¸éœ€è¦éå†æ•´ä¸ªå¯¹è±¡å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„cleanObjã€‚
// ç®€å•åœ°ä½¿ç”¨restè§£æ„æ¥æå–å‡ºSSNï¼Œå¹¶å°†å…¶ä½™çš„ä¿å­˜åœ¨cleanObjä¸­ã€‚

let { SSN, ...cleanObj } = {
	firstName: 'john',
	lastName: 'smith',
	SSN: '123-45-6789',
	race: 'martian',
}

cleanObj; //{	firstName: 'john', lastName: 'smith', race: 'martian' }

```

- ###  6. å¯¹è±¡çš„æ‰©å±•å±æ€§ (Spread properties for Objects)
æ‰©å±•å±æ€§çœ‹èµ·æ¥å°±åƒå…·æœ‰ä¸‰ä¸ªç‚¹çš„Restå±æ€§ä¸€æ ·`...`, ä½†åŒºåˆ«åœ¨äºæ‚¨ä½¿ç”¨æ‰©å±•æ¥åˆ›å»ºï¼ˆé‡æ–°æ„å»ºï¼‰æ–°å¯¹è±¡ã€‚

>æç¤ºï¼šæ‰©å±•æ“ä½œç¬¦ç”¨äºç­‰å·çš„å³ä¾§ã€‚Restç”¨äºç­‰å·çš„å·¦ä¾§ã€‚

```js
// person å’Œ account åˆå¹¶
const person = { fName: 'john', age: 20 };
const account = { name: 'bofa', amount: '$1000' };

// é€šè¿‡æ‰©å±•è¿ç®—ç¬¦æå–personå’Œaccountçš„å±æ€§ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ä¸­ã€‚
const personAndAccount = { ...person, ...account };
personAndAccount; // {fName: 'john', age: 20, name: 'bofa', amount: '$1000' }

```

- ###  7. RegExp å£°æ˜

è¿™æ˜¯å¯¹RegExpçš„å¢å¼ºï¼Œå®ƒå…è®¸æˆ‘ä»¬ç¡®ä¿æŸäº›å­—ç¬¦ä¸²ç«‹å³*å­˜åœ¨äº*å…¶ä»–å­—ç¬¦ä¸²ä¹‹å‰ã€‚

æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç»„(`?<=...`)ï¼ˆé—®å·ï¼Œå°äºï¼Œç­‰äºï¼‰æ¥æŸ¥æ‰¾è‚¯å®šçš„å£°æ˜ã€‚

æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨(`?<=...`)ï¼ˆé—®å·ï¼Œå°äºï¼Œæ„Ÿå¹å·ï¼‰æ¥æŸ¥çœ‹å¦å®šå£°æ˜ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œåªè¦-veå£°æ˜é€šè¿‡ï¼Œå°±ä¼šåŒ¹é…ã€‚

æ­£é¢å£°æ˜ï¼šå‡è®¾æˆ‘ä»¬æƒ³è¦ç¡®ä¿ï¼ƒç¬¦å·åœ¨å•è¯`winning`ä¹‹å‰å­˜åœ¨ï¼ˆå³ï¼š`#winning`ï¼‰å¹¶ä¸”å¸Œæœ›æ­£åˆ™è¡¨è¾¾å¼åªè¿”å›å­—ç¬¦ä¸²â€œwinningâ€ã€‚è¿™æ˜¯ä½ å¦‚ä½•å†™å®ƒã€‚

```js
/(?<=#).*/.test('winning'); // false
/(?<=#).*/.test('#winning'); // true

//ä¹‹å‰
'#winning'.match(/#.*/)[0]; // '#wining',åŒ…å«#

//ES2018å
'#winning'.match(/(?<=#).*/)[0]; // 'wining' æ²¡æœ‰#, #æ˜¯ç”¨æ¥éªŒè¯çš„ã€‚ 

```

å¦å®šå£°æ˜ï¼šå‡è®¾æˆ‘ä»¬æƒ³ä»è¿™äº›æ•°å­—ä¹‹å‰çš„å…·æœ‰â‚¬ç¬¦å·è€Œä¸æ˜¯$ç¬¦å·çš„è¡Œä¸­æå–æ•°å­—ã€‚

```js
// 3.00ä¸èƒ½åŒ¹é…ï¼Œå› ä¸ºç¬¦å·$åœ¨å‰é¢

'A gallon of milk is $3.00'.match(/(?<\$)\d+\.?\d+/); // null

// 2.43åŒ¹é…æˆåŠŸï¼Œå› ä¸ºå‰é¢æ²¡æœ‰ç¬¦å·$
//å½“åŒ¹é…æ—¶ï¼Œä¸åŒ…å«ç¬¦å·â‚¬
'A gallon of milk is â‚¬3.00'.match(/(?<\$)\d+\.?\d+/)[0]; //2.43


```

- ### 8. RegExp Unicodeå±æ€§è½¬ä¹‰

è¦ç¼–å†™RegExpæ¥åŒ¹é…å„ç§Unicodeå­—ç¬¦å¹¶ä¸å®¹æ˜“ã€‚åƒ`\w`ï¼Œ`\W`ï¼Œ`\d`ç­‰åªèƒ½åŒ¹é…è‹±æ–‡å­—ç¬¦å’Œæ•°å­—ã€‚ä½†æ˜¯å¯¹äºå°åº¦è¯­ï¼Œå¸Œè…Šè¯­ç­‰å…¶ä»–è¯­è¨€çš„æ•°å­—å‘¢ï¼Ÿ

è¿™å°±æ˜¯Unicode Property Escapesçš„ç”¨æ­¦ä¹‹åœ°ã€‚ç»“æœæ˜¯ï¼ŒUnicodeä¸ºæ¯ä¸ªç¬¦å·ï¼ˆå­—ç¬¦ï¼‰æ·»åŠ äº†å…ƒæ•°æ®å±æ€§ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å¯¹å„ç§ç¬¦å·è¿›è¡Œåˆ†ç»„æˆ–æè¿°å„ç§ç¬¦å·ã€‚

ä¾‹å¦‚ï¼ŒUnicodeæ•°æ®åº“å°†æ‰€æœ‰å°åœ°è¯­å­—ç¬¦ï¼ˆà¤¹à¤¿à¤¨à¥à¤¦à¥€ï¼‰ç»„åˆåœ¨ä¸€ä¸ªåä¸ºå…·æœ‰å€¼`Devanagari`çš„`Script`è„šæœ¬çš„å±æ€§ä¸‹ï¼Œå¦ä¸€ä¸ªåä¸ºå…·æœ‰ç›¸åŒå€¼`Devanagari`çš„`Script_Extensions`çš„å±æ€§	ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æœç´¢`Script=Devanagari`å¹¶è·å¾—æ‰€æœ‰å°åœ°æ–‡å­—ç¬¦ã€‚

> Devanagari(æ¢µæ–‡)å¯ç”¨äºé©¬æ‹‰åœ°è¯­ï¼ŒåŒ—å°åº¦è¯­ï¼Œæ¢µè¯­ç­‰å„ç§å°åº¦è¯­è¨€ã€‚

ä»ECMAScript 2018å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`\p`è½¬ä¹‰å­—ç¬¦å’Œ`{Script=Devanagari}`æ¥åŒ¹é…æ‰€æœ‰å°åº¦å­—ç¬¦ã€‚**ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨RegExä¸­ä½¿ç”¨ï¼š`\p{Script=Devanagari}`æ¥åŒ¹é…æ‰€æœ‰æ¢µæ–‡å­—ç¬¦ã€‚**

```js
//ä»–è·ŸéšåŒ¹é…å¤šä¸ªå°åœ°æ–‡å­—ç¬¦
/^\p{Script=Devanagari}+$/u.test('à¤¹à¤¿à¤¨à¥à¤¦à¥€'); //true  
//PSï¼šæœ‰3ä¸ªå°åœ°æ–‡å­—ç¬¦h

```

åŒæ ·ï¼ŒUnicodeæ•°æ®åº“å°†æ‰€æœ‰å¸Œè…Šå­—ç¬¦ç»„åˆä¸º`Script_Extensions`ï¼ˆå’Œ`Script`ï¼‰å±æ€§ï¼Œå…¶å€¼ä¸º`Greek`ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`Script_Extensions=Greek`æˆ–`Script=Greek`æ¥æœç´¢æ‰€æœ‰å¸Œè…Šå­—ç¬¦ã€‚

**ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨RegExä¸­ä½¿ç”¨ï¼š`\p{Script = Greek}`æ¥åŒ¹é…æ‰€æœ‰å¸Œè…Šå­—ç¬¦ã€‚**

```js
//ä»¥ä¸‹åŒ¹é…ä¸€ä¸ªå¸Œè…Šå­—ç¬¦
/\p{Script_Extensions=Greek}/u.test('Ï€'); // true

```


æ­¤å¤–ï¼ŒUnicodeæ•°æ®åº“å°†å„ç§ç±»å‹çš„`Emojis`(è¡¨æƒ…ç¬¦å·)å­˜å‚¨åœ¨å±æ€§å€¼ä¸ºâ€œtrueâ€çš„å¸ƒå°”å±æ€§`Emoji`ï¼Œ`Emoji_Component`ï¼Œ`Emoji_Presentation`ï¼Œ`Emoji_Modifier`å’Œ`Emoji_Modifier_Base`ä¸‹ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•åœ°é€‰æ‹©è¡¨æƒ…ç¬¦å·æ¥æŸ¥æ‰¾æ‰€æœ‰è¡¨æƒ…ç¬¦å·ã€‚

**ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š`\p{Emoji}`ï¼Œ`\Emoji_Modifier`ç­‰æ¥åŒ¹é…å„ç§Emojisã€‚**


ä¸‹é¢çš„ä¾‹å­å°†ä¼šæ¸…æ¥šã€‚
```js
// ä¸‹é¢æ˜¯åŒ¹é…è¡¨æƒ…å­—ç¬¦
/\p{Emoji}/u.test('â¤ï¸'); //true
// ä¸‹é¢çš„æ“ä½œå¤±è´¥äº†ï¼Œå› ä¸ºé»„è‰²çš„emojisæ²¡æœ‰Emoji_Modifier!
/\p{Emoji}\p{Emoji_Modifier}/u.test('âœŒï¸'); //false
//ä¸‹é¢çš„æ“ä½œæ˜¯åŒ¹é…çš„ï¼Œ\p{Emoji} ç´§è·Ÿåé¢æ˜¯ \p{Emoji_Modifier}
/\p{Emoji}\p{Emoji_Modifier}/u.test('âœŒğŸ½'); //true
// è§£é‡Š:
// é»˜è®¤æƒ…å†µä¸‹ï¼Œèƒœåˆ©è¡¨æƒ…æ˜¯é»„è‰²çš„ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç›¸åŒè¡¨æƒ…çš„æ£•è‰²ã€é»‘è‰²æˆ–å…¶ä»–ï¼Œå®ƒä»¬è¢«è®¤ä¸ºæ˜¯åŸå§‹è¡¨æƒ…çš„å˜ä½“ï¼Œå¹¶ä½¿ç”¨ä¸¤ä¸ªunicodeå­—ç¬¦è¡¨ç¤ºã€‚ä¸€ä¸ªæ˜¯åŸå§‹è¡¨æƒ…ç¬¦å·ï¼Œå¦ä¸€ä¸ªæ˜¯é¢œè‰²çš„unicodeå­—ç¬¦ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œè™½ç„¶æˆ‘ä»¬åªçœ‹åˆ°ä¸€ä¸ªæ£•è‰²çš„èƒœåˆ©è¡¨æƒ…ç¬¦å·ï¼Œä½†å®ƒå®é™…ä¸Šä½¿ç”¨äº†ä¸¤ä¸ªunicodeå­—ç¬¦ï¼Œä¸€ä¸ªç”¨äºè¡¨æƒ…ç¬¦å·ï¼Œå¦ä¸€ä¸ªç”¨äºæ£•è‰²ã€‚

//åœ¨Unicodeæ•°æ®åº“ä¸­ï¼Œè¿™äº›é¢œè‰²å…·æœ‰Emoji_Modifierå±æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨\p{Emoji}å’Œ\p{Emoji_Modifier}æ¥æ­£ç¡®å’Œå®Œå…¨åŒ¹é…æ£•è‰²çš„è¡¨æƒ…ç¬¦å·ã€‚

/\p{Emoji}\p{Emoji_Modifier}/u.test('âœŒğŸ½'); //true

```

æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§å†™çš„â€œPâ€ï¼ˆ`\P`ï¼‰è½¬ä¹‰å­—ç¬¦è€Œä¸æ˜¯å°pï¼ˆ`\p`ï¼‰æ¥å¦å®šåŒ¹é…ã€‚

å‚è€ƒï¼š
[ECMAScript 2018 Proposal](https://mathiasbynens.be/notes/es-unicode-property-escapes)

- ###  9. Promise.prototype.finally()

finally() æ˜¯æ·»åŠ åˆ°Promiseçš„æ–°å®ä¾‹æ–¹æ³•ã€‚ä»–çš„ä¸»è¦æƒ³æ³•æ˜¯å…è®¸åœ¨è§£å†³æˆ–æ‹’ç»ä¹‹åè¿è¡Œå›è°ƒä»¥å¸®åŠ©æ¸…ç†äº‹æƒ…ã€‚**`finally`å›è°ƒè¢«è°ƒç”¨æ—¶æ²¡æœ‰ä»»ä½•ä»·å€¼ï¼Œå¹¶ä¸”æ— è®ºå¦‚ä½•æ€»æ˜¯è¢«æ‰§è¡Œã€‚**

æˆ‘ä»¬æ¥çœ‹çœ‹å„ç§æƒ…å†µ:

```js
// Resolve

let started = true;
let myPromise = new Promise(function(resolve, reject) {
	resolve('all good');
})
	.then(val => {
		console.log(val); //all good
	})
	.catch(e => {
		console.log(e)l // è·³è¿‡
	})
	.finally(() => {
		console.log('This function is always executed!');
		started = false; // æ¸…é™¤
	})


```

```js
// Reject
let started = true;
let myPromise = new Promise(function(resolve, reject) {
	resolve('reject apple');
})
	.then(val => {
		console.log(val); //reject apple
	})
	.catch(e => {
		console.log(e)l //catchè¢«è·³è¿‡
	})
	.finally(() => {
		//æ³¨æ„è¿™é‡Œæ²¡æœ‰ä»»ä½•å€¼
		console.log('This function is always executed!');
		started = false; //æ¸…é™¤
	})

```

```js
//é”™è¯¯æƒ…å†µ1
//Promise æŠ›å‡ºé”™è¯¯


let started = true;
let myPromise = new Promise(function(resolve, reject) {
	throw new Error('Error');
})
	.then(val => {
		console.log(val); // è·³è¿‡
	})
	.catch(e => {
		console.log(e)l // å‡ºç°é”™è¯¯catchè¢«è°ƒç”¨
	})
	.finally(() => {
		// æ³¨æ„è¿™é‡Œæ²¡æœ‰ä»»ä½•å€¼
		console.log('This function is always executed!');
		started = false; // æ¸…é™¤
	})


```

```js

// é”™è¯¯ä»â€œcatchâ€äº‹ä»¶ä¸­æŠ›å‡º

let started = true;
let myPromise = new Promise(function(resolve, reject) {
	throw new Error('something happend');
})
	.then(val => {
		console.log(val); // è·³è¿‡
	})
	.catch(e => {
		throw new Error('throw another error')
	})
	.finally(() => {
		// æ³¨æ„è¿™é‡Œæ²¡æœ‰ä»»ä½•å€¼
		console.log('This function is always executed!');
		started = false; //æ¸…é™¤
		// é”™è¯¯å½¢å¼çš„æ•è·å°†éœ€è¦åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨å‡½æ•°æ¥å¤„ç†
	})


```
- ### 10. å¼‚æ­¥è¿­ä»£ (Asynchronous Iteration)

è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚åŸºæœ¬ä¸Šå®ƒå…è®¸æˆ‘ä»¬è½»æ¾åˆ›å»ºå¼‚æ­¥ä»£ç å¾ªç¯ï¼

è¿™ä¸ªç‰¹æ€§å¢åŠ äº†ä¸€ä¸ªæ–°çš„â€œfor-await-ofâ€å¾ªç¯ï¼Œå…è®¸æˆ‘ä»¬è°ƒç”¨å¼‚æ­¥å‡½æ•°æ¥è¿”å›Promiseï¼ˆæˆ–å¸¦æœ‰ä¸€ç³»åˆ—Promiseçš„æ•°ç»„ï¼‰ã€‚å¾ˆé…·çš„æ˜¯å¾ªç¯ç­‰å¾…æ¯ä¸ªPromiseåœ¨ä¸‹ä¸€ä¸ªå¾ªç¯å‰è§£æã€‚

```js 
const promises = [
	new Promise(resolve => resolve(1)),
	new Promise(resolve => resolve(2)),
	new Promise(resolve => resolve(3)),
]
// ä¹‹å‰
// for-ofä½¿ç”¨å¸¸è§„åŒæ­¥è¿­ä»£å™¨
// ä¸ç­‰å¾…Promise å»è§£å†³

async function test1() {
	for (const obj of promise) {
		console.log(obj) // è®°å½•3 æ¡Promiseå¯¹è±¡
	}
}

// ä»¥å
// for-wait-ofä½¿ç”¨å¼‚æ­¥è¿­ä»£

async function test2() {
	for await (const obj of promises) {
		console.log(obj); // 1,2, 3
	}
}

test1() // promise, promise, promise
test2() // 1,2,3 


```