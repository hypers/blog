<!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css"><meta name="keywords" content="Hypers Blog Front-End"><link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.1"><meta property="og:type" content="website"><meta property="og:title" content="HYPERS 前端团队博客"><meta property="og:url" content="http://blog.rsuitejs.com/index.html"><meta property="og:site_name" content="HYPERS 前端团队博客"><meta property="og:locale" content="zh-Hans"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="HYPERS 前端团队博客"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",sidebar:{position:"left",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.rsuitejs.com/"><title>HYPERS 前端团队博客</title><script>!function(e,t,n,c,a,r,s,h){e[n]=e[n]||[],e[n].push(r),e[r]=e[r]||function(){return(e[r].q=e[r].q||[]).push(arguments)},(s=t.createElement(c)).src="//t.hypers.com.cn/hwt.js?v=1.6",s.async=1,(h=t.getElementsByTagName(c)[0]).parentNode.insertBefore(s,h)}(window,document,"HyperAnalyticsObject","script",0,"_ha"),_ha("create","4080"),_ha("send","pageview")</script></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">HYPERS 前端团队博客</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div class="hypers-loop-warpper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 124.51 53.99" id="hypers_loop_svg"><defs><style>.hypers-loop-warpper{position:absolute;top:50px;left:50%;margin-left:-76px}.cls-1{fill:none;stroke-linecap:round;stroke-miterlimit:10;stroke-width:4px;stroke:url(#New_Gradient_Swatch_7)}#hypers_loop_svg{width:152px}#loop_svg path{animation:dash 20s infinite linear;stroke-dasharray:32,10}@keyframes dash{to{stroke-dashoffset:800}}</style><lineargradient id="New_Gradient_Swatch_7" y1="26.99" x2="124.51" y2="26.99" gradientunits="userSpaceOnUse"><stop offset="0" stop-color="#51e8ff"/><stop offset="1" stop-color="#1361aa"/></lineargradient></defs><title>loop</title><g id="loop" data-name="图层 2"><g id="loop_svg" data-name="Layer 2"><path class="cls-1" d="M62.2 27 44.7 44.7c-9.8 9.8-25.6 9.8-35.4 0s-9.8-25.6 0-35.4 25.6-9.8 35.4 0l0 0 35.2 35.4c9.8 9.8 25.6 9.8 35.4 0s9.8-25.6 0-35.4-25.6-9.8-35.4 0L62.2 27z"></path></g></g></svg></div><div class="starry-warpper"><div class="stars"></div><div class="stars2"></div><div class="stars3"></div></div><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2019/02/02/dart/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2019/02/02/dart/" itemprop="url">Dart 简单入门</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-02T10:20:51+00:00">2019-02-02</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">4,467</span></div></div></header><div class="post-body" itemprop="articleBody"> <img src="/2019/02/02/dart/logo.png" title="这个世界到底还需不需要一门新的语言？"><blockquote><ul><li>推荐图书：<a href="https://book.douban.com/subject/27074797/" target="_blank" rel="noopener">Dart编程语言 - 【美】Gilad Bracha</a></li><li>推荐阅读官方文档：<a href="https://www.dartlang.org/guides/language/language-tour" target="_blank" rel="noopener">A Tour of the Dart Language</a></li><li>建议切一个窗口打开<a href="https://dartpad.dartlang.org/" target="_blank" rel="noopener">DartPad</a>边看边码，更能加深印象！</li></ul></blockquote><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>Dart 其实并不算一门非常新的语言，最早版本发行与 2011 年 10 月，目标是取代 JavaScript 成为下一代 Web 开发语言（很显然他失败了）。截止发稿已经发布了 2.x 版本，与初始版本并无太多改动，保持了兼容性。他没有像同胞哥哥 <a href="https://zh.wikipedia.org/wiki/Go" target="_blank" rel="noopener">Golang</a> 在后端占有一席之地一样在 Web 端有所作为，而是不温不火好几年，直到 <a href="https://zh.wikipedia.org/wiki/Flutter" target="_blank" rel="noopener">Flutter</a> 的出现才有所改善。<br>语言本身来说，他是一门<strong>强类型且面向类编程</strong>的语言，前端朋友如果长期以 JavaScript 为主力语言的话可能会有些许不适应，但是相信在短暂的学习之后就会上手，并喊出“真香”。<br>笔者是实实在在的新手，本文更多也是作为读书笔记，如果有什么不足或纰漏，还望各位不吝赐教，定虚心接受。</p><h1 id="语言设计理念"><a href="#语言设计理念" class="headerlink" title="语言设计理念"></a>语言设计理念</h1><h2 id="万物皆对象"><a href="#万物皆对象" class="headerlink" title="万物皆对象"></a>万物皆对象</h2><p>不同于 JavaScript 和 Java 有对象和基本值，在 Dart 的世界里<strong>任何事物都是对象</strong>，无一例外。这一点可以让我们更好地去操作我们的代码而不用关心拆装箱等问题，在一定程度上简化了构建逻辑，简化了实现任务。</p><h2 id="面向接口编程，而非面向实现"><a href="#面向接口编程，而非面向实现" class="headerlink" title="面向接口编程，而非面向实现"></a>面向接口编程，而非面向实现</h2><p>关注对象的行为而非内部实现时 OOP 的核心原则，在 Dart 中这一原则被更好地强调和实现，具体方式有以下几条：</p><ul><li>在 Dart 中并不存在声明的接口，因为<strong>所有的类都可以被当做接口</strong>，不管其他类是否采用了同样的底层实现（部分 core type 除外）</li><li>Dart 中没有 final 方法，<strong>允许几乎重写所有方法</strong>（部分内置操作符除外）。</li><li>Dart 把对象进行抽象封装，<strong>所有的操作都是通过存取来改变对象状态的</strong>，即在其他语言中习以为常的<strong><code>=</code>赋值和<code>.</code>取值在 Dart 中也只是<code>get()</code>和<code>set()</code>的语法糖</strong>。</li></ul><h2 id="类型时为开发服务"><a href="#类型时为开发服务" class="headerlink" title="类型时为开发服务"></a>类型时为开发服务</h2><p>这点我感觉与 TypeScript 的理念（或是说实现效果）比较相近，毕竟大家觉得强类型语言写起来舒服的原因就是<strong>清晰的接口</strong>和<strong>便捷的 IDE 提示</strong>，往编译层面来说就是为编译器提供更好的预判，从而优化性能。 Dart 在类型方面采用了可选类型(Sound type) ，算是在强弱类型之间找到了一个平衡：</p><ul><li>类型在语法层面时可选的</li><li>类型对运行时的语义没有影响。</li></ul><p>这意味着你也可以把 Dart 当做一门动态类型语言来编写，虽然不推荐，但是还是在一定程度上给了开发者很高的自由度，让其他语言的开发者更快迁移到 Dart 上来。</p><h1 id="字面量"><a href="#字面量" class="headerlink" title="字面量"></a>字面量</h1><blockquote><p>当然别忘了，他们也都还是对象</p></blockquote><ul><li>整数 <em>int</em>： <code>1</code> <code>2</code> <code>3</code></li><li>浮点数 <em>double</em>：（遵循 IEEE754 标准的 64-bit 浮点数）<code>1.0</code><blockquote><p>在 Dart 2.1 之后 <code>double value = 1;</code> 将自动转为（等价于） <code>double value = 1.0;</code></p></blockquote></li><li>数字 <em>num</em>： 作为<em>int</em>和<em>double</em>的父级</li><li>布尔 <em>bool</em>： <code>true</code></li><li><p>字符串 <em>String</em>： （转义字符用法与 JavaScript 相似）</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="keyword">var</span> man = <span class="string">'Mick'</span>;</span><br><span class="line">  <span class="keyword">var</span> s1 = <span class="string">'It\'s hot today!'</span>;</span><br><span class="line">  <span class="keyword">var</span> s2 = <span class="string">"It's hot today!"</span>;</span><br><span class="line">  <span class="keyword">var</span> s3 = <span class="string">"'It\'s hot today!'<span class="subst">$man</span> said."</span>;</span><br><span class="line">  <span class="keyword">var</span> s4 = <span class="string">'''</span></span><br><span class="line"><span class="string">  It!</span></span><br><span class="line"><span class="string">  is!</span></span><br><span class="line"><span class="string">  hot!</span></span><br><span class="line"><span class="string">  today!</span></span><br><span class="line"><span class="string">  '''</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//You can create a “raw” string by prefixing it with r:</span></span><br><span class="line">  <span class="keyword">var</span> s = <span class="string">r'In a raw string, not even \n gets special treatment.'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>列表 <em>List</em>： <code>[1,2,3]</code></p></li><li>映射 <em>Map</em>： <code>{&#39;1&#39;:1,&#39;2&#39;:2}</code><blockquote><p>注意：虽然和JavaScript中的对象很像但是不能通过<code>.something</code>的方式代替<code>[&#39;sonething&#39;]</code></p></blockquote></li><li>函数 <em>Function</em>： <code>()=&gt;{}</code></li><li>Symbol： (使用 <code>#</code> 开头，后面跟着一个或多个<code>.</code>分割的标识符或运算符，基本用不到) <code>#MyClass</code> <code>#com.evil_empire.forTheWin</code></li></ul><h1 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h1><p>和其他 C-style 语法相似，你之前学到的知识大概率是能用得上的。如果你写过 Java / Kotlin 的话应该会感觉更加亲切，因为真的很像。</p><h2 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h2><p>变量声明方面其实没有声明特别的地方，你可以<del>凭自己的喜好</del>给变量增加类型：<br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=<span class="string">'1'</span>;<span class="comment">//不带类型的变量声明</span></span><br><span class="line"><span class="built_in">String</span> b =<span class="string">'1'</span>;<span class="comment">//带类型的变量声明</span></span><br><span class="line"><span class="keyword">const</span> c=<span class="string">'1'</span>;<span class="comment">//常量声明</span></span><br><span class="line"><span class="keyword">final</span> d=<span class="string">'1'</span>;<span class="comment">//在调用后被初始化</span></span><br><span class="line"><span class="keyword">var</span> e;<span class="comment">//未初始化的变量将被初始化为null</span></span><br></pre></td></tr></table></figure><p></p><h2 id="来写一个类吧"><a href="#来写一个类吧" class="headerlink" title="来写一个类吧"></a>来写一个类吧</h2><ul><li><p>你可以像这样写一个类</p><blockquote><p>注意： Dart 是<strong>不支持函数重载</strong>的</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x, y;</span><br><span class="line">  Point(a,b)&#123;</span><br><span class="line">    x = a;</span><br><span class="line">    y = b;</span><br><span class="line">  &#125;</span><br><span class="line">  scale(factor)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Point(x * factor, y * factor);<span class="comment">//在 Dart2 中你可以无条件省略 new 关键词</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>你还可以像 Java / C++ 一样写个类</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">  <span class="built_in">int</span> x, y;</span><br><span class="line">  Point(a,b)&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = a;</span><br><span class="line">    <span class="keyword">this</span>.y = b;</span><br><span class="line">  &#125;</span><br><span class="line">  scale(factor)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Point(x * factor, y * factor);<span class="comment">//在 Dart2 中你可以无条件省略 new 关键词</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>当然， Dart 也有自己的语法糖</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x, y;</span><br><span class="line">  Point(<span class="keyword">this</span>.x,<span class="keyword">this</span>.y);<span class="comment">//第一个参数将会自动赋给 x ，第二个参数会自动赋给y</span></span><br><span class="line">  scale(factor) =&gt;  <span class="keyword">new</span> Point(x * factor, y * factor);<span class="comment">//在 Dart2 中你可以无条件省略 new 关键词</span></span><br><span class="line">  <span class="keyword">operator</span> +(p) =&gt; <span class="keyword">new</span> Poinit(x + p.x,y + p.y);<span class="comment">//就像在 c++ 里一样，你又可以重写运算符了！</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在 Dart 中还支持了 <code>staic</code> / <code>final</code> / <code>const</code> 关键词，还有 <code>const构造方法</code></p><blockquote><p>还有抽象关键词<code>abstract</code>，与 Java 用法相似，在此就不做举例。</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">var</span> onlyOne = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> neverChange = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">final</span> lazyLoad;<span class="comment">//推荐大部分变量都设置为 final ，可以在声明时初始化，也可以在构造函数初始化（必须二选一）。</span></span><br><span class="line">  <span class="keyword">get</span> onlyOne()&#123;&#125;</span><br><span class="line">  <span class="keyword">set</span> onlyOne()&#123;&#125;</span><br><span class="line">  Foo(lazyOne):lazyLoad=lazyOne,<span class="keyword">super</span>(key:lazyOne);<span class="comment">// final 值也可以通过构造函数后冒号初始化，调用父类构造函数 super。</span></span><br><span class="line">  <span class="keyword">const</span> Foo()<span class="comment">//所有 const 关键词赋值中调用的只能是常量或字面量，因为所有被 const 修饰的方法/变量将会在编译阶段被求值。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Dart 的类支持了 <code>extends</code> / <code>with</code> / <code>implements</code>，按需取用。</p><blockquote><ul><li>和其他现代语言一样， Dart 支持单继承多接口，在此基础上还增加了饱受争议的 mixin （一对多）。</li><li><code>mixin</code> 关键词也可以替代 <code>class</code> 作为声明关键词来使用，以专门编写用于 mixin 的类，如果此 mixin 要求对象实现接口则使用 <code>on</code> 关键词在最后修饰。</li><li>可参考<a href="https://juejin.im/post/5c4881dae51d45098e4d96cf" target="_blank" rel="noopener">Flutter Dart语法(1):extends 、 implements 、 with的用法与区别</a></li></ul></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">  m(p, q) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mixin Bar2 on Bar &#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * on修饰符要求mixin对象的父类实现了Bar接口</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> m(q, p) &#123;</span><br><span class="line">    <span class="keyword">super</span>.m(q, p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo1</span> <span class="keyword">extends</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 1. Dart中的继承是单继承</span></span><br><span class="line"><span class="comment">    * 2. 构造函数不能继承</span></span><br><span class="line"><span class="comment">    * 3. 子类重写超类的方法，要用@override</span></span><br><span class="line"><span class="comment">    * 4. 子类调用超类的方法，要用super</span></span><br><span class="line"><span class="comment">    * 注意：不可以重写父类中声明变量的set和get方法（隐式），同时重写的方法要与父类中方法参数个数相同。</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">  <span class="comment">//...other codes</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo2</span> <span class="keyword">implements</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 1. class 就是 interface</span></span><br><span class="line"><span class="comment">    * 2. 当class被当做interface用时，class中的方法就是接口的方法，需要在子类里重新实现，在子类实现的时候要加@override</span></span><br><span class="line"><span class="comment">    * 3. 当class被当做interface用时，class中的成员变量也需要在子类里重新实现。在成员变量前加@override</span></span><br><span class="line"><span class="comment">    * 4. 实现接口可以有多个</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  m(p, q) &#123;&#125;</span><br><span class="line">  <span class="comment">//...other codes</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo3</span> <span class="title">with</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 1. mixins类只能继承自object</span></span><br><span class="line"><span class="comment">    * 2. mixins类不能有构造函数</span></span><br><span class="line"><span class="comment">    * 3. 一个类可以mixins多个mixins类</span></span><br><span class="line"><span class="comment">    * 4. 可以mixins多个类，不破坏Dart的单继承</span></span><br><span class="line"><span class="comment">    * 注意：mixin有点像extends，但是我理解上更像是原型链的模型，with后即链上对象，采取的是覆盖原则，即靠后的生效。（甚至可以粗暴地理解为复制代码）</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">  <span class="comment">//...other codes</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo4</span> <span class="keyword">extends</span> <span class="title">Bar</span> <span class="title">with</span> <span class="title">Bar2</span> </span>&#123;</span><br><span class="line">  <span class="comment">//通过继承的方式实现。</span></span><br><span class="line">  <span class="comment">//...other codes</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo5</span> <span class="keyword">extends</span> <span class="title">Foo2</span> <span class="title">with</span> <span class="title">Bar2</span> </span>&#123;</span><br><span class="line">  <span class="comment">//通过继承的方式实现。</span></span><br><span class="line">  <span class="comment">//...other codes</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><ul><li><p>基本的函数可以参考下面，包含了<em>三目运算符</em>和<em>错误抛出</em>。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">maxElement(a)&#123;</span><br><span class="line">  <span class="comment">//你可以在maxElement前面加上返回类型 如 int maxElement(a)</span></span><br><span class="line">  <span class="comment">//你也可以在a前面标注上类型来声明a的类型  如 maxElement(List&lt;int&gt; a)</span></span><br><span class="line">  <span class="keyword">var</span> currentMax = a.isEmpty</span><br><span class="line">    ? <span class="keyword">throw</span> <span class="string">'Maximal element undefined for empty array'</span> : a[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; a.length; i++)&#123;</span><br><span class="line">    currentMax = max(a[i],currentMax);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> currentMax;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Dart还支持了<code>可选参数</code>/<code>具名参数</code>/<code>参数默认值</code>，当然你也可以使用<code>@required</code>来标注具名参数中必须传入的值。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> foo1(a, [ b = <span class="number">1</span>] )&#123;<span class="comment">//a为参数，b为可选参数并设置了默认值1</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;a&#125;</span>,<span class="subst">$&#123;b&#125;</span>'</span>);<span class="comment">//当仅有变量时也可以简写为print('$a,$b')</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> foo2(a,&#123; <span class="meta">@required</span> b, c = <span class="number">0</span> &#125;)&#123;<span class="comment">//a为参数，b/c为具名参数,b为必传，c设置了默认值0</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;a&#125;</span>,<span class="subst">$&#123;b&#125;</span>,<span class="subst">$&#123;c&#125;</span>'</span>);  </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  foo1(<span class="number">1</span>, <span class="number">2</span>);<span class="comment">//1,2</span></span><br><span class="line">  foo2(<span class="number">1</span>, b:<span class="number">2</span>);<span class="comment">//1,2,0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>支持函数作为参数传递，当然也就支持箭头函数，不同于 JavaScript 中的箭头函数和普通函数有 this 的区别， <strong>Dart 中的箭头函数就是实实在在的“糖”</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()=&gt;&#123;&#125;;</span><br></pre></td></tr></table></figure></li><li><p>Dart同样支持了闭包，但是和JavaScript的又不大一样，这里有个不得不吐的槽：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);<span class="comment">//他会很不合预期地打出五个5</span></span><br><span class="line">  &#125;, <span class="number">1000</span> * i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码应该是前端面试的常客了，但是与它类似的代码在 Dart 中就显得很“正常”</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    Timer(<span class="built_in">Duration</span>(seconds: i), () &#123;</span><br><span class="line">      <span class="built_in">print</span>(i);<span class="comment">//0,1,2,3,4</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为在 Dart 中，每次执行 for 都会给代码新建一个 <em>context</em> ，所以在<strong>每次执行的 Timer 都是一个全新的 <code>i</code></strong></p></li><li><p>在函数的调用上页支持<code>..</code>来级联操作，它不像<code>.</code>会返回调用后的结果，而是返回被调用者本身，这样的设计给链式调用多了一种选择。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="comment">/*1*/</span><span class="string">"Hello"</span>.length.toString();<span class="comment">//5</span></span><br><span class="line">  <span class="comment">/*2*/</span><span class="string">"Hello"</span>..length.toString();<span class="comment">//Hello</span></span><br><span class="line">  <span class="comment">/*第2行等价于*/</span></span><br><span class="line">  <span class="string">"Hello"</span>.length;</span><br><span class="line">  <span class="string">"Hello"</span>.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>如果函数调用<code>()</code>也是”糖”？没错。他就是<code>.call()</code>方法的语法糖。所以你可以给对象加上<code>call</code>方法以使用<code>()</code>来调用方法。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fakeFunc</span> </span>&#123;</span><br><span class="line">  call() &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'works!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> a = fakeFunc();</span><br><span class="line">  a();<span class="comment">//works!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Dart同样支持迭代器语法，支持同步和异步</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">naturalsTo(n) <span class="keyword">sync</span>* &#123;<span class="comment">//同步迭代器</span></span><br><span class="line">  <span class="keyword">var</span> k=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(k&lt;n) <span class="keyword">yield</span> k++;</span><br><span class="line">&#125;</span><br><span class="line">naturalsTo(n) <span class="keyword">async</span>* &#123;<span class="comment">//异步迭代器</span></span><br><span class="line">  <span class="keyword">var</span> k=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(k&lt;n) <span class="keyword">yield</span> <span class="keyword">await</span> k++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>还有一个不得不提的方法 <code>noSuchMethod</code> ，如果运行时对象没有对应的方法，将会调用这个方法，这使得我们可以由此做一些”Hack“(关于反射和动态代码)<br>对于 <code>noSuchMethod()</code> 的参数只有一个 <code>Invocation</code> 。关于 <code>Invocation</code> 的布尔属性所辨认的方法调用的句法形式，如下表所示：</p></li></ul><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">x.y</th><th style="text-align:center">x.y = e</th><th style="text-align:center">x.y(…)</th></tr></thead><tbody><tr><td style="text-align:center">isMethod</td><td style="text-align:center">false</td><td style="text-align:center">false</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">isGetter</td><td style="text-align:center">true</td><td style="text-align:center">false</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">isSetter</td><td style="text-align:center">false</td><td style="text-align:center">true</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">isAccessor</td><td style="text-align:center">true</td><td style="text-align:center">true</td><td style="text-align:center">false</td></tr></tbody></table><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  noSuchMethod(Invocation inv)=&gt;<span class="built_in">print</span>(<span class="string">'fallback!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="keyword">var</span> a = A();</span><br><span class="line">  <span class="comment">//注：更多时候你将会被 IDE 拦下来</span></span><br><span class="line">  a.x();<span class="comment">//'fallback!'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其他语句"><a href="#其他语句" class="headerlink" title="其他语句"></a>其他语句</h2><ul><li>支持 c-style 的 <code>if(){}else if(){}else{}</code></li><li>支持以<code>{}</code>分界的块状作用域，不允许块之间互相递归声明。</li><li>支持 c-style 的 <code>for</code> / <code>while</code> / <code>do-while</code> 循环以及相对应的 <code>continue</code> / <code>break</code>（还有对应的 label 也是支持的），还支持了 <code>for-in</code> 语法来快捷遍历集合类</li><li>支持 <code>switch-case</code> 多条件选择<blockquote><p>注意：case 的值仅能为常量，且不允许<a href="https://en.wikipedia.org/wiki/Switch_statement#Fallthrough" target="_blank" rel="noopener">falls-through</a>，必须使用 break 跳出。</p></blockquote></li><li>支持 <code>assert</code> 语法，优化开发体验。<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="built_in">int</span> x = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">assert</span>(x&gt;<span class="number">0</span>);<span class="comment">//在开发模式下报错</span></span><br><span class="line">  x++;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p> Dart 支持最舒适的 <code>throw</code> + <code>try{}catch(){}finally{}</code>语法，不多说！</p><h1 id="库-模块"><a href="#库-模块" class="headerlink" title="库/模块"></a>库/模块</h1><ul><li>Dart 的模块化比较像 C / C++ / Java ，他是将 import 的文件直接注入到<strong>当前文件全局作用域</strong>下的。</li><li><p>Dart 引入关键词为 <code>import</code> ，支持使用 <code>as</code> 来重命名，还有 <code>deferred as</code> 来延迟加载，也支持使用 <code>show</code> / <code>hide</code> 组合器来限定引入范围。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'stack.dart'</span> show pop,push;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'advancedStack.dart'</span> <span class="keyword">as</span> stack2 hide pop,push;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'mayUseless.dart'</span> deferred <span class="keyword">as</span> rarelyUsed;<span class="comment">//只有在使用时才会被加载</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  onLoad(loadSuccess)=&gt;loadSuceess?doStuff():makeExcusses();</span><br><span class="line">  rarelyUsed.loadLibrary().then(onLoad);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>export</code> 用于中转某个库需要在当前文件暴露的方法，但并不是和 import 配套使用的。同样支持使用 <code>show</code> / <code>hide</code> 组合器来限定引入范围。</p><blockquote><p>类似于 JavaScript(ES6) 里的 <code>export from</code> 语法</p></blockquote><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="string">'stack.dart'</span> hide pop;</span><br></pre></td></tr></table></figure></li><li><p>还有一个对我而言比较陌生的关键词： <code>part</code> ，有的时候一个库可能太大，不能方便的保存在一个文件当中。Dart 允许我们把一个库拆分成一个或者多个较小的 part 组件。或者我们想让某一些库共享它们的私有对象的时候，我们需要使用 part。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A.dart</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'stack.dart'</span> show pop;</span><br><span class="line"><span class="keyword">part</span> <span class="string">'A_1.dart'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A_1.dart</span></span><br><span class="line"><span class="keyword">part</span> of <span class="string">'A.dart'</span>;</span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  pop(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里我们可以看到，<code>A_1.dart</code>是<code>part of &#39;A.dart&#39;</code>的文件，可以理解为，<code>A_1</code>是<code>A</code>的一部分。在<code>part test2.dart</code>中，我们并没有引入<code>stack.dart</code>包就直接使用了<code>pop</code>方法，是因为，在 part 中， import 进来的库是共享命名空间的。<br>不是所有的库都有名称，但如果使用 part 来构建库，那么库必须要命名。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span> xxx;</span><br></pre></td></tr></table></figure><p>每个子 part 都存放在各自的文件中。但是它们共享同一作用域，库的内部命名空间，以及所有的导入（import）。</p></li></ul><h1 id="可选类型-泛型"><a href="#可选类型-泛型" class="headerlink" title="可选类型/泛型"></a>可选类型/泛型</h1><p>正如之前提到的，Dart 中的类型是可选的，它仅为开发提供便利，同时也提供了泛型来约束集合内的类型，用法与 C++ / Java 类似。<br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">num</span>&gt; list;</span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>,<span class="built_in">int</span>&gt; map;</span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>,<span class="keyword">dynamic</span>&gt; map2;</span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="keyword">dynamic</span>,<span class="keyword">dynamic</span>&gt; freeMap;<span class="comment">//等价于 Map freeMap;</span></span><br></pre></td></tr></table></figure><p></p><p>你可以使用 <code>is</code> 关键字来检测是否为某个类的实例<br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123; </span><br><span class="line">  <span class="keyword">var</span> v=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">  v <span class="keyword">is</span> <span class="built_in">Map</span>;<span class="comment">//false</span></span><br><span class="line">  v <span class="keyword">is</span> <span class="built_in">List</span>;<span class="comment">//true </span></span><br><span class="line">  v <span class="keyword">is</span> <span class="built_in">Object</span>;<span class="comment">//always true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>还可以使用 <code>as</code> 进行强制类型转换,这部分与 Java 的强制类型转换相似，只能是从子类转化为父类。<br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="number">1</span> <span class="keyword">as</span> <span class="built_in">Object</span>;<span class="comment">//无意义的转换，仅作举例</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h1 id="注解（Annotation）"><a href="#注解（Annotation）" class="headerlink" title="注解（Annotation）"></a>注解（Annotation）</h1><blockquote><p>对于 Java 程序员来说<a href="https://blog.csdn.net/briblue/article/details/73824058" target="_blank" rel="noopener">注解</a>一定不陌生，对于 JavaScript 程序员来说，可能听说过<a href="http://es6.ruanyifeng.com/#docs/decorator" target="_blank" rel="noopener">装饰器(decorator)</a>的提案。</p></blockquote><p>注解作为<a href="https://www.dartlang.org/guides/language/language-tour#metadata" target="_blank" rel="noopener">元数据(metadata)</a>，是为了给代码提供额外的信息，提升编码体验，大部分时候并不会对代码产生实质性影响。它以<code>@</code>打头，后跟一个<code>const常量</code>或调用一个<code>const构造函数</code>，内置对象有 <code>@required</code> <code>@deprecated</code> 等。<br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Television</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// _Deprecated: Use [turnOn] instead._</span></span><br><span class="line">  <span class="meta">@deprecated</span></span><br><span class="line">  <span class="keyword">void</span> activate() &#123;</span><br><span class="line">    turnOn();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// Turns the TV's power on.</span></span><br><span class="line">  <span class="keyword">void</span> turnOn() &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>你也可以自定义一个注解：<br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> who;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> what;</span><br><span class="line">  <span class="keyword">const</span> Todo(<span class="keyword">this</span>.who, <span class="keyword">this</span>.what);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Todo</span>(<span class="string">'seth'</span>, <span class="string">'make this do something'</span>)<span class="comment">//使用自定义注解</span></span><br><span class="line"><span class="keyword">void</span> doSomething() &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'do something'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h1 id="Async"><a href="#Async" class="headerlink" title="Async"></a>Async</h1><p>让我很喜欢 JavaScript 的原因之一就是在疏不在堵的异步调用（在 Node 上更为明显），这也是很多 JavaScript 新手的末日。<br>很高兴在 Dart 上能找到几乎一样的实现方案: <code>Future</code><br></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"><span class="comment">//定义了返回结果值为String类型</span></span><br><span class="line">Future&lt;<span class="built_in">String</span>&gt; getData(<span class="built_in">String</span> category) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> request = <span class="keyword">await</span> _httpClient.getUrl(<span class="built_in">Uri</span>.parse(url));  </span><br><span class="line">  <span class="keyword">var</span> response = <span class="keyword">await</span> request.close();</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> response.transform(utf8.decoder).join();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() <span class="keyword">async</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> data = <span class="keyword">await</span> getData(<span class="string">'test'</span>);<span class="comment">//调用 async 函数</span></span><br><span class="line">  <span class="comment">//链式调用，捕获异常</span></span><br><span class="line">  <span class="keyword">var</span> future = <span class="comment">//调式调用</span></span><br><span class="line">    <span class="keyword">new</span> Future</span><br><span class="line">    .then(funA(),onError: (e) &#123; handleError(e); &#125;)</span><br><span class="line">    .then(funB(),onError: (e) &#123; handleError(e); &#125;);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>与 ES6 中的 <code>Promise</code> 用法基本一致，具名参数的加成使得代码可读性更佳，真香！</p><h1 id="一些有趣的特性"><a href="#一些有趣的特性" class="headerlink" title="一些有趣的特性"></a>一些有趣的特性</h1><ul><li>在 Dart 程序中一定存在一个入口函数，和 C 一样，我们把他命名为 main ()，虽然是在面向类编程，但是我们依然可以<strong>在文件的最外层可以直接声明函数和变量</strong>，这点和 Java 倒是不大一样，但其实幕后工作编译器都帮我们做好了，我们只管写就好了!</li><li>Dart 中的整数长度取决于你的内存大小（编译成目标语言除外<del>。说你呢 JavaScript ！</del>）</li><li><code>final</code> 声明的值将是采用<strong>懒加载的方式</strong>，即<strong>只有当<code>get()</code>被调用之前，该变量才会被初始化</strong>。</li><li>在 Dart 中<strong>只有 <code>bool</code> 类型的 <code>true</code> 是 <code>true</code> ,其他对象都是 <code>false</code></strong> ，<del>虽然不影响编译，</del>但是在你写出来的时候 IDE 就会拼命给你报错了。</li><li>Dart <strong>不存在内部类</strong>，类中<strong>不存在私有方法</strong>所有的方法都是可见并大部分都是可以重写的。私有变量以<code>_</code>开头，如 <code>_privateThing</code>;</li></ul><h1 id="一些高级特性"><a href="#一些高级特性" class="headerlink" title="一些高级特性"></a>一些高级特性</h1><blockquote><p>由于本文为入门教程，笔者对于 Dart 也是入门不久，以下高级编程部分用的较少，作为补充仅提及，后续可能会更新补充，有兴趣的读者可以自行搜索学习。</p></blockquote><ul><li>代理 (Proxy)</li><li>反射 (Mirror)</li></ul></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/12/12/webpack-optimize/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/12/12/webpack-optimize/" itemprop="url">Webpack性能优化整理</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-12T10:16:46+00:00">2018-12-12</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">1,300</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="加速构建"><a href="#加速构建" class="headerlink" title="加速构建"></a>加速构建</h1><h2 id="配置webpack中的Devtool选项"><a href="#配置webpack中的Devtool选项" class="headerlink" title="配置webpack中的Devtool选项"></a>配置webpack中的Devtool选项</h2><blockquote><p><strong>开发环境</strong>推荐：<br>cheap-module-eval-source-map<br><strong>生产环境</strong>推荐：<br>cheap-module-source-map （这也是下版本 webpack 使用-d命令启动 debug 模式时的默认选项）</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  devtool: <span class="string">'cheap-module-eval-source-map'</span>,</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>模式</th><th>解释</th></tr></thead><tbody><tr><td>eval</td><td>每个 module 会封装到 eval 里包裹起来执行，并且会在末尾追加注释 //@ sourceURL.</td></tr><tr><td>source-map</td><td>生成一个 SourceMap 文件.</td></tr><tr><td>hidden-source-map</td><td>和 source-map 一样，但不会在 bundle 末尾追加注释.</td></tr><tr><td>inline-source-map</td><td>生成一个 DataUrl 形式的 SourceMap 文件.</td></tr><tr><td>eval-source-map</td><td>每个 module 会通过 eval() 来执行，并且生成一个 DataUrl 形式的 SourceMap .</td></tr><tr><td>cheap-source-map</td><td>生成一个没有列信息（column-mappings）的 SourceMaps 文件，不包含 loader 的 sourcemap（譬如 babel 的 sourcemap）</td></tr><tr><td>cheap-module-source-map</td><td>生成一个没有列信息（column-mappings）的 SourceMaps 文件，同时 loader 的 sourcemap 也被简化为只包含对应行的。</td></tr></tbody></table><blockquote><p>注1：webpack 不仅支持这 7 种，而且它们还是可以任意组合上面的 eval、inline、hidden 关键字，就如文档所说，你可以设置 souremap 选项为 cheap-module-inline-source-map。<br>注2：如果你的 modules 里面已经包含了 SourceMaps ，你需要用 source-map-loader 来和合并生成一个新的 SourceMaps 。</p></blockquote> <img src="/2018/12/12/webpack-optimize/devtools-compare.jpeg" title="SourceMap 模式效率对比图"><ul><li>使用 cheap 模式可以大幅提高 souremap 生成的效率。大部分情况我们调试并不关心列信息，而且就算 sourcemap 没有列，有些浏览器引擎（例如 v8） 也会给出列信息。</li><li>使用 eval 方式可大幅提高持续构建效率。参考官方文档提供的速度对比表格可以看到 eval 模式的编译速度很快。</li><li>使用 module 可支持 babel 这种预编译工具（在 webpack 里做为 loader 使用）。</li><li>使用 eval-source-map 模式可以减少网络请求。这种模式开启 DataUrl 本身包含完整 sourcemap 信息，并不需要像 sourceURL 那样，浏览器需要发送一个完整请求去获取 sourcemap 文件，这会略微提高点效率。而生产环境中则不宜用 eval，这样会让文件变得极大。</li></ul><h2 id="uglifyJS使用parallel参数"><a href="#uglifyJS使用parallel参数" class="headerlink" title="uglifyJS使用parallel参数"></a>uglifyJS使用parallel参数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">    parallel: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="为babel-loader设置cacheDir"><a href="#为babel-loader设置cacheDir" class="headerlink" title="为babel-loader设置cacheDir"></a>为babel-loader设置cacheDir</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            cacheDirectory:<span class="literal">true</span>,<span class="comment">//或者制定文件夹</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>cacheDirectory：默认值为<code>false</code>。当有设置时，指定的目录将用来缓存 loader 的执行结果。之后的 webpack 构建，将会尝试读取缓存，来避免在每次执行时，可能产生的、高性能消耗的 Babel 重新编译过程(recompilation process)。如果设置了一个空值<code>(loader: &#39;babel-loader?cacheDirectory&#39;)</code>或者<code>true (loader: babel-loader?cacheDirectory=true)</code>，loader 将使用默认的缓存目录<code>node_modules/.cache/babel-loader</code>，如果在任何根目录下都没有找到<code>node_modules</code>目录，将会降级回退到操作系统默认的临时文件目录。</p></blockquote><h2 id="使用happypack插件"><a href="#使用happypack插件" class="headerlink" title="使用happypack插件"></a>使用happypack插件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> HappyPack = <span class="built_in">require</span>(<span class="string">'happypack'</span>);</span><br><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>);</span><br><span class="line"><span class="keyword">const</span> happyThreadPool = HappyPack.ThreadPool(&#123; <span class="attr">size</span>: os.cpus().length &#125;);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"> <span class="built_in">module</span>: &#123;</span><br><span class="line">   rules: [</span><br><span class="line">     &#123;</span><br><span class="line">       test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">       <span class="comment">//把对.js 的文件处理交给id为happyBabel 的HappyPack 的实例执行</span></span><br><span class="line">       loader: <span class="string">'happypack/loader?id=happyBabel'</span>,</span><br><span class="line">       <span class="comment">//排除node_modules 目录下的文件</span></span><br><span class="line">       exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">     &#125;,</span><br><span class="line">   ]</span><br><span class="line"> &#125;,</span><br><span class="line">plugins: [</span><br><span class="line">   <span class="keyword">new</span> HappyPack(&#123;</span><br><span class="line">       <span class="comment">//用id来标识 happypack处理那里类文件</span></span><br><span class="line">     id: <span class="string">'happyBabel'</span>,</span><br><span class="line">     <span class="comment">//如何处理  用法和loader 的配置一样</span></span><br><span class="line">     loaders: [&#123;</span><br><span class="line">       loader: <span class="string">'babel-loader?cacheDirectory=true'</span>,</span><br><span class="line">     &#125;],</span><br><span class="line">     <span class="comment">//共享进程池</span></span><br><span class="line">     threadPool: happyThreadPool,</span><br><span class="line">     <span class="comment">//允许 HappyPack 输出日志</span></span><br><span class="line">     verbose: <span class="literal">true</span>,</span><br><span class="line">   &#125;)</span><br><span class="line"> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ul><li>在 Loader 配置中，所有文件的处理都交给了 happypack/loader 去处理，使用紧跟其后的<code>querystring ?id=babel</code>去告诉 happypack/loader 去选择哪个 HappyPack 实例去处理文件。</li><li>在 Plugin 配置中，新增了两个 HappyPack 实例分别用于告诉 happypack/loader 去如何处理<code>.js</code>和<code>.css</code>文件。选项中的 id 属性的值和上面<code>querystring</code>中的<code>?id=babel</code>相对应，选项中的<code>loaders</code>属性和<code>Loader</code>配置中一样。</li></ul></blockquote><h2 id="使用parallel-webpack"><a href="#使用parallel-webpack" class="headerlink" title="使用parallel-webpack"></a>使用parallel-webpack</h2><blockquote><p>npm install parallel-webpack –save-dev</p></blockquote><p>可代替webpack使用</p><h1 id="减小尺寸"><a href="#减小尺寸" class="headerlink" title="减小尺寸"></a>减小尺寸</h1><h2 id="使用WebpackDeepScopeAnalysisPlugin插件"><a href="#使用WebpackDeepScopeAnalysisPlugin插件" class="headerlink" title="使用WebpackDeepScopeAnalysisPlugin插件"></a>使用WebpackDeepScopeAnalysisPlugin插件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> WebpackDeepScopeAnalysisPlugin = <span class="built_in">require</span>(<span class="string">'webpack-deep-scope-plugin'</span>).default;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  plugins:[</span><br><span class="line">      <span class="keyword">new</span> WebpackDeepScopeAnalysisPlugin(),</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><ul><li>首先，要用到tree-shaking，必然要保证引用的模块都是ES6规范的。例如lodash要替换为lodash-es。</li><li>在项目中，注意要把babel设置module: false，避免babel将模块转为CommonJS规范。</li><li>在package.json中定义sideEffect: false，这也是为了避免出现import xxx导致模块内部的一些函数执行后影响全局环境，却被去除掉的情况。</li></ul></blockquote><h2 id="使用webpack-externals选项"><a href="#使用webpack-externals选项" class="headerlink" title="使用webpack externals选项"></a>使用webpack externals选项</h2><p><strong>index.html</strong>:<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script  src="https://code.jquery.com/jquery-3.1.0.js"&lt;/script&gt;</span><br><span class="line"><span class="comment">&lt;!--other scripts--&gt;</span></span><br></pre></td></tr></table></figure><p></p><p><strong>webpack.config.js</strong>:<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  externals: &#123;</span><br><span class="line">    jquery: <span class="string">'jQuery'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p><blockquote><p>可使用该选项将模块以cdn的形式引入，保持代码中的引入</p></blockquote><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><blockquote><ul><li><a href="https://juejin.im/post/58293502a0bb9f005767ba2f" target="_blank" rel="noopener">[webpack]devtool里的7种SourceMap模式是什么鬼？</a></li><li><a href="https://webpack.docschina.org/plugins/uglifyjs-webpack-plugin/" target="_blank" rel="noopener">Webpack - UglifyjsWebpackPlugin</a></li><li><a href="https://webpack.docschina.org/loaders/babel-loader/" target="_blank" rel="noopener">Webpack - babel-loader</a></li><li><a href="https://github.com/amireh/happypack" target="_blank" rel="noopener">amireh/happypack: Happiness in the form of faster webpack build times.</a></li><li><a href="https://github.com/trivago/parallel-webpack" target="_blank" rel="noopener">trivago/parallel-webpack: Builds multi-config webpack projects in parallel</a></li><li><a href="https://juejin.im/post/5b8ce49df265da438151b468" target="_blank" rel="noopener">体积减少80%！释放webpack tree-shaking的真正潜力 - 掘金</a></li><li><a href="https://webpack.docschina.org/configuration/externals/" target="_blank" rel="noopener">Webpack - 外部扩展(externals)</a></li></ul></blockquote></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/08/30/schema-typed/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/08/30/schema-typed/" itemprop="url">前端数据校验从建模开始</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-30T00:00:00+00:00">2018-08-30</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">1,386</span></div></div></header><div class="post-body" itemprop="articleBody"><p>前端开发过程中你们觉得处理什么业务功能最烦人？</p><p>做前端已经有很长一段时间了，不知道大家是否和我有同样的感受，在一些 Web 应用中表单处理起来比其他功能模块都麻烦，很多体力活。往往在数据的校验会很费时间。</p><p>为了能够把这部分代码更有条理,我们把数据校验部分通过 Schema 预先定义一个数据模型，把数据扔进去，返回校验结果。</p><p>接下来我介绍一下这个工具，<a href="https://github.com/rsuite/schema-typed" target="_blank" rel="noopener"><code>schema-typed</code></a> 是一个数据建模及数据验证工具, 它可以非常方便的设计的表单数据结构，当然它不限于在表单使用。如果你在产品中使用了 React , 那配合 <a href="https://rsuitejs.com/components/form" target="_blank" rel="noopener">React Suite</a> 的表单组件简直就是如虎添翼。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install schema-typed --save</span><br></pre></td></tr></table></figure><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; SchemaModel, StringType, DateType, NumberType &#125; <span class="keyword">from</span> <span class="string">'schema-typed'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userModel = SchemaModel(&#123;</span><br><span class="line">  username: StringType().isRequired(<span class="string">'用户名不能为空'</span>),</span><br><span class="line">  email: StringType().isEmail(<span class="string">'请输入正确的邮箱'</span>),</span><br><span class="line">  age: NumberType(<span class="string">'年龄应该是一个数字'</span>).range(<span class="number">18</span>, <span class="number">30</span>, <span class="string">'年龄应该在 18 到 30 岁之间'</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> checkResult = userModel.check(&#123;</span><br><span class="line">  username: <span class="string">'foobar'</span>,</span><br><span class="line">  email: <span class="string">'foo@bar.com'</span>,</span><br><span class="line">  age: <span class="number">40</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(checkResult);</span><br></pre></td></tr></table></figure><p><code>checkResult</code> 返回结构是:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    username: &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    email: &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    age: &#123; <span class="attr">hasError</span>: <span class="literal">true</span>, <span class="attr">errorMessage</span>: <span class="string">'年龄应该在 18 到 30 岁之间'</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多重验证"><a href="#多重验证" class="headerlink" title="多重验证"></a>多重验证</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">StringType()</span><br><span class="line">  .minLength(<span class="number">6</span>, <span class="string">'不能少于 6 个字符'</span>)</span><br><span class="line">  .maxLength(<span class="number">30</span>, <span class="string">'不能大于 30 个字符'</span>)</span><br><span class="line">  .isRequired(<span class="string">'该字段不能为空'</span>);</span><br></pre></td></tr></table></figure><h2 id="自定义验证"><a href="#自定义验证" class="headerlink" title="自定义验证"></a>自定义验证</h2><p>通过 <code>addRule</code> 函数自定义一个规则。</p><p>如果是对一个字符串类型的数据进行验证，可以通过 <code>pattern</code> 方法设置一个正则表达式进行自定义验证。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myModel = SchemaModel(&#123;</span><br><span class="line">  field1: StringType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[1-9][0-9]&#123;3&#125;\s?[a-zA-Z]&#123;2&#125;$/</span>.test(value);</span><br><span class="line">  &#125;, <span class="string">'请输入合法字符'</span>),</span><br><span class="line">  field2: StringType().pattern(<span class="regexp">/^[1-9][0-9]&#123;3&#125;\s?[a-zA-Z]&#123;2&#125;$/</span>, <span class="string">'请输入合法字符'</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">schema.check(&#123; <span class="attr">field1</span>: <span class="string">''</span>, <span class="attr">field2</span>: <span class="string">''</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  field1: &#123;</span></span><br><span class="line"><span class="comment">    hasError: true,</span></span><br><span class="line"><span class="comment">    errorMessage: '请输入合法字符'</span></span><br><span class="line"><span class="comment">  &#125;,</span></span><br><span class="line"><span class="comment">  field2: &#123;</span></span><br><span class="line"><span class="comment">    hasError: true,</span></span><br><span class="line"><span class="comment">    errorMessage: '请输入合法字符'</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure><h2 id="自定义验证-多字段交叉验证"><a href="#自定义验证-多字段交叉验证" class="headerlink" title="自定义验证 - 多字段交叉验证"></a>自定义验证 - 多字段交叉验证</h2><p>例如，验证两次输入密码是否一致</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = SchemaModel(&#123;</span><br><span class="line">  password1: StringType().isRequired(<span class="string">'该字段不能为空'</span>),</span><br><span class="line">  password2: StringType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value !== data.password1) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;, <span class="string">'两次密码不一致'</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">schema.check(&#123; <span class="attr">password1</span>: <span class="string">'123456'</span>, <span class="attr">password2</span>: <span class="string">'root'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  password1: &#123; hasError: false &#125;,</span></span><br><span class="line"><span class="comment">  password2: &#123;</span></span><br><span class="line"><span class="comment">    hasError: true,</span></span><br><span class="line"><span class="comment">    errorMessage: '两次密码不一致'</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure><h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><ul><li>StringType</li><li>NumberType</li><li>ArrayType</li><li>DateType</li><li>ObjectType</li><li>BooleanType</li></ul><h3 id="StringType"><a href="#StringType" class="headerlink" title="StringType"></a>StringType</h3><ul><li>isRequired()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().isRequired(<span class="string">'该字段不能为空'</span>);</span><br></pre></td></tr></table></figure><ul><li>isEmail(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().isEmail(<span class="string">'请输入正确的邮箱地址'</span>);</span><br></pre></td></tr></table></figure><ul><li>isURL(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().isURL(<span class="string">'请输入正确的URL地址'</span>);</span><br></pre></td></tr></table></figure><ul><li>isOneOf(Array: items, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().isOneOf([<span class="string">'Javascript'</span>, <span class="string">'CSS'</span>], <span class="string">'只能输入 `Javascript`和 `CSS`'</span>);</span><br></pre></td></tr></table></figure><ul><li>containsLetter(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().containsLetter(<span class="string">'必须包含英文字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>containsUppercaseLetter(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().containsUppercaseLetter(<span class="string">'必须包含大写的英文字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>containsLowercaseLetter(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().containsLowercaseLetter(<span class="string">'必须包含小写的英文字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>containsLetterOnly(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().containsLetterOnly(<span class="string">'只能包含的英文字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>containsNumber(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().containsNumber(<span class="string">'必须包含数字'</span>);</span><br></pre></td></tr></table></figure><ul><li>pattern(Object: regexp, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().pattern(<span class="regexp">/^[1-9][0-9]&#123;3&#125;\s?[a-zA-Z]&#123;2&#125;$/</span>, <span class="string">'请输入合法字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>rangeLength(Number: minLength, Number: maxLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().rangeLength(<span class="number">6</span>, <span class="number">30</span>, <span class="string">'字符个数只能在 6 - 30 之间'</span>);</span><br></pre></td></tr></table></figure><ul><li>minLength(Number: minLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().minLength(<span class="number">6</span>, <span class="string">'最小需要6个字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>maxLength(Number: maxLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringType().minLength(<span class="number">30</span>, <span class="string">'最大只能30个字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>addRule(Function: onValid, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">StringType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/^[1-9][0-9]&#123;3&#125;\s?[a-zA-Z]&#123;2&#125;$/</span>.test(value);</span><br><span class="line">&#125;, <span class="string">'请输入合法字符'</span>);</span><br></pre></td></tr></table></figure><h3 id="NumberType"><a href="#NumberType" class="headerlink" title="NumberType"></a>NumberType</h3><ul><li>isRequired()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().isRequired(<span class="string">'该字段必填'</span>);</span><br></pre></td></tr></table></figure><ul><li>isInteger(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().isInteger(<span class="string">'只能是整型'</span>);</span><br></pre></td></tr></table></figure><ul><li>isOneOf(Array: items, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().isOneOf([<span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>], <span class="string">'只能是`5`,`10`,`15`'</span>);</span><br></pre></td></tr></table></figure><ul><li>pattern(Object: regexp, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().pattern(<span class="regexp">/^[1-9][0-9]&#123;3&#125;$/</span>, <span class="string">'请输入合法字符'</span>);</span><br></pre></td></tr></table></figure><ul><li>range(Number: minLength, Number: maxLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().range(<span class="number">18</span>, <span class="number">40</span>, <span class="string">'请输入 18 - 40 之间的数字'</span>);</span><br></pre></td></tr></table></figure><ul><li>min(Number: min, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().min(<span class="number">18</span>, <span class="string">'最小值 18'</span>);</span><br></pre></td></tr></table></figure><ul><li>max(Number: min, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NumberType().max(<span class="number">40</span>, <span class="string">'最大值 40'</span>);</span><br></pre></td></tr></table></figure><ul><li>addRule(Function: onValid, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NumberType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value % <span class="number">5</span> === <span class="number">0</span>;</span><br><span class="line">&#125;, <span class="string">'请输入有效的数字'</span>);</span><br></pre></td></tr></table></figure><h3 id="ArrayType"><a href="#ArrayType" class="headerlink" title="ArrayType"></a>ArrayType</h3><ul><li>isRequired()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().isRequired(<span class="string">'该字段必填'</span>);</span><br></pre></td></tr></table></figure><ul><li>rangeLength(Number: minLength, Number: maxLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().rangeLength(<span class="number">1</span>, <span class="number">3</span>, <span class="string">'至少选择1个，但不能超过3个'</span>);</span><br></pre></td></tr></table></figure><ul><li>minLength(Number: minLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().minLength(<span class="number">1</span>, <span class="string">'至少选择1个'</span>);</span><br></pre></td></tr></table></figure><ul><li>maxLength(Number: maxLength, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().maxLength(<span class="number">3</span>, <span class="string">'不能超过3个'</span>);</span><br></pre></td></tr></table></figure><ul><li>unrepeatable(String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().unrepeatable(<span class="string">'不能出现重复选项'</span>);</span><br></pre></td></tr></table></figure><ul><li>of(Object: type, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().of(StringType().isEmail(), <span class="string">'格式错误'</span>);</span><br></pre></td></tr></table></figure><ul><li>addRule(Function: onValid, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ArrayType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value.length % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line">&#125;, <span class="string">'好事成双'</span>);</span><br></pre></td></tr></table></figure><h3 id="DateType"><a href="#DateType" class="headerlink" title="DateType"></a>DateType</h3><ul><li>isRequired()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DateType().isRequired(<span class="string">'日期不能为空'</span>);</span><br></pre></td></tr></table></figure><ul><li>range(Date: min, Date: max, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DateType().range(</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'08/01/2017'</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'08/30/2017'</span>),</span><br><span class="line">  <span class="string">'时间应该在 08/01/2017 - 08/30/2017 之间'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>min(Date: min, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DateType().min(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'08/01/2017'</span>), <span class="string">'时间的最小值 08/01/2017'</span>);</span><br></pre></td></tr></table></figure><ul><li>max(Date: max, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DateType().max(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'08/30/2017'</span>), <span class="string">'时间的最大值 08/30/2017'</span>);</span><br></pre></td></tr></table></figure><ul><li>addRule(Function: onValid, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DateType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value.getDay() === <span class="number">2</span>;</span><br><span class="line">&#125;, <span class="string">'只能选择周二'</span>);</span><br></pre></td></tr></table></figure><h3 id="ObjectType"><a href="#ObjectType" class="headerlink" title="ObjectType"></a>ObjectType</h3><ul><li>isRequired()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ObjectType().isRequired(<span class="string">'该对象不能为空'</span>);</span><br></pre></td></tr></table></figure><ul><li>shape(Object: types)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ObjectType().shape(&#123;</span><br><span class="line">  email: StringType().isEmail(<span class="string">'应该是一个 email'</span>),</span><br><span class="line">  age: NumberType().min(<span class="number">18</span>, <span class="string">'年龄应该大于18岁'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>addRule(Function: onValid, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ObjectType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (value.id || value.email) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;, <span class="string">'id 与 email 必须有一个不能为空'</span>);</span><br></pre></td></tr></table></figure><h3 id="BooleanType"><a href="#BooleanType" class="headerlink" title="BooleanType"></a>BooleanType</h3><ul><li>isRequired()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BooleanType().isRequired(<span class="string">'该字段不能为空'</span>);</span><br></pre></td></tr></table></figure><ul><li>addRule(Function: onValid, String: errorMessage)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ObjectType().addRule(<span class="function">(<span class="params">value, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">'undefined'</span> &amp;&amp; A === <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;, <span class="string">'当 A 等于 10 的时候，该值必须为空'</span>);</span><br></pre></td></tr></table></figure></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/08/28/react-code-view/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/08/28/react-code-view/" itemprop="url">让 Markdown 中的代码可以实时运行</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-28T00:00:00+00:00">2018-08-28</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">505</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>让 Markdown 中的代码可以实时运行，为什么会有这样一个需求？</p><p>在我们前端团队中，技术相关的文档都采用 Markdown 编写， 文档中往往会伴随很多示例代码，我们希望大家在阅读文档的时候，可以运行示例代码，看到效果。</p><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><ul><li>让 Markdown 中的代码可以运行，并预览效果。</li><li>代码可以在线编辑。</li><li>不影响整个文档流的布局。</li><li>支持 React, 支持代码高亮。</li><li>可以配置 babel。</li></ul><p>明确需求以后，写了一个 React 组件来满足这些功能， <a href="https://github.com/simonguo/react-code-view" target="_blank" rel="noopener"><code>react-code-view</code></a> ， 首先看一下效果：</p><p><img src="https://user-images.githubusercontent.com/1203827/44707274-a30c0f80-aad6-11e8-8cc5-9cf7daf4d9e2.gif" alt="preview"></p><p>在线预览: <a href="https://simonguo.github.io/react-code-view/" target="_blank" rel="noopener">https://simonguo.github.io/react-code-view/</a></p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><ul><li>就通过 <code>markdown-loader</code> 与 <code>html-loader</code> 解析 Markdown 文档。</li><li>通过正则表达式取出 code ，交给 <code>codemirror</code></li><li>把 <code>codemirror</code> 中的代码通过 babel 编译，再通过 ReactDOM.render 渲染到指定的容器中。</li></ul><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-code-view</span><br></pre></td></tr></table></figure><h3 id="配置-webpack"><a href="#配置-webpack" class="headerlink" title="配置 webpack"></a>配置 webpack</h3><p>在 webpack 中需要添加对 <code>markdown-loader</code> 的支持。 需要安装：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install html-loader --save-dev</span><br><span class="line">npm install markdown-loader --save-dev</span><br><span class="line">npm install react-markdown-reader --save-dev</span><br></pre></td></tr></table></figure><p><code>webpack.config.js</code> 配置</p><p><strong>&gt;=webpack 2.x +</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> markdownRenderer = <span class="built_in">require</span>(<span class="string">'react-markdown-reader'</span>).renderer;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  test: <span class="regexp">/\.md$/</span>,</span><br><span class="line">  use: [&#123;</span><br><span class="line">    loader: <span class="string">'html-loader'</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    loader: <span class="string">'markdown-loader'</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">      pedantic: <span class="literal">true</span>,</span><br><span class="line">      renderer: markdownRenderer(<span class="comment">/**languages:Array&lt;string&gt;**/</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>languages 默认值：<code>[&quot;javascript&quot;, &quot;bash&quot;, &quot;xml&quot;, &quot;css&quot;, &quot;markdown&quot;, &quot;less&quot;]</code>;</p><p>Github: <a href="https://github.com/simonguo/react-markdown-reader" target="_blank" rel="noopener">https://github.com/simonguo/react-markdown-reader</a></p><h3 id="添加-Babel"><a href="#添加-Babel" class="headerlink" title="添加 Babel"></a>添加 Babel</h3><p>示例代码中通常是使用到 ES2015+ , React 等，需要对代码实时做编译，所以在 html 中引入 babel :<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//cdn.staticfile.org/babel-standalone/6.24.0/babel.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> CodeView <span class="keyword">from</span> <span class="string">'react-code-view'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'~react-code-view/lib/less/index.less'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'rsuite'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;CodeView dependencies=&#123;&#123; Button &#125;&#125; &gt;</span><br><span class="line">  &#123;<span class="built_in">require</span>(<span class="string">'./example.md'</span>)&#125;</span><br><span class="line">&lt;<span class="regexp">/CodeView&gt;</span></span><br></pre></td></tr></table></figure><p>源代码都统一写在 markdown 中，参考:<br><a href="https://raw.githubusercontent.com/simonguo/react-code-view/master/docs/example.md" target="_blank" rel="noopener">example.md</a></p><blockquote><p>这里需要注意的是把需要运行的代码一定要放在 <code>&lt;!--start-code--&gt;</code> 与 <code>&lt;!--end-code--&gt;</code> 之间。</p></blockquote><h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><table><thead><tr><th>Name</th><th>Type</th><th>Default value</th><th>Description</th></tr></thead><tbody><tr><td>dependencies</td><td>Object</td><td></td><td>依赖的组件</td></tr><tr><td>showCode</td><td>boolean</td><td>true</td><td>显示代码</td></tr><tr><td>babelTransformOptions</td><td>Object</td><td>{ presets: [‘stage-0’, ‘react’, ‘es2015’] }</td><td>babel 配置参数 <a href="https://babeljs.io/docs/usage/api/#options" target="_blank" rel="noopener">options</a></td></tr></tbody></table><h2 id="谁在用？"><a href="#谁在用？" class="headerlink" title="谁在用？"></a>谁在用？</h2><ul><li><a href="https://rsuitejs.com/components/button" target="_blank" rel="noopener">React Suite</a></li></ul></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/05/29/cdnjs/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/05/29/cdnjs/" itemprop="url">提交一个仓库到 CDNJS</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-29T10:16:20+00:00">2018-05-29</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">2,370</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><img src="/2018/05/29/cdnjs/cdnjs-home-screenshoot.png" title="cdnjs 官网截屏"><p>本篇文章主要介绍了：如何提交自己的库到 <a href="https://cdnjs.com/" target="_blank" rel="noopener">cdnjs</a>，提交要求，详细的提交步骤及遇到的问题与解决办法。</p><div class="post-button text-center"> <a class="btn" href="/2018/05/29/cdnjs/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/04/25/rsuite-v3/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/04/25/rsuite-v3/" itemprop="url">React Suite v3.0 正式版发布</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-25T00:00:00+00:00">2018-04-25</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">477</span></div></div></header><div class="post-body" itemprop="articleBody"><p>相信很多人会好奇，React Suite 是什么？</p><p><img src="https://user-images.githubusercontent.com/1203827/39177217-3c49254c-47e1-11e8-9380-760c9e25c48e.png" alt=""></p><p>React Suite 是 HYPERS 前端团队和 UX 团队开源的一套基于 React 的 UI 组件库，能够帮助您快速构建一个企业级应用。</p><p>官网访问地址： <a href="https://rsuitejs.com" target="_blank" rel="noopener">rsuitejs.com</a></p><div class="post-button text-center"> <a class="btn" href="/2018/04/25/rsuite-v3/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/04/19/webpack-mutiple-theme-solution/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/04/19/webpack-mutiple-theme-solution/" itemprop="url">webpack 换肤功能多主题/配色样式打包解决方案</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-19T19:15:52+00:00">2018-04-19</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">1,800</span></div></div></header><div class="post-body" itemprop="articleBody"> <img src="/2018/04/19/webpack-mutiple-theme-solution/pallete.jpg" title="色阶"><p>本文主要详细介绍了，如何使用 <a href="https://webpack.js.org/" target="_blank" rel="noopener">webpack</a>，打包多套不同主题的解决方案以及实践中所遇到的问题。</p><div class="post-button text-center"> <a class="btn" href="/2018/04/19/webpack-mutiple-theme-solution/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/04/11/es2016-17-18/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/04/11/es2016-17-18/" itemprop="url">ECMAScript 2016, 2017, 和2018中新增功能的示例</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-11T00:00:00+00:00">2018-04-11</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">6,651</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="以下是-ECMAScript-2016-2017-和-2018-中新增功能的示例"><a href="#以下是-ECMAScript-2016-2017-和-2018-中新增功能的示例" class="headerlink" title="以下是 ECMAScript 2016, 2017, 和 2018 中新增功能的示例"></a>以下是 ECMAScript 2016, 2017, 和 2018 中新增功能的示例</h1><p><a href="https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e" target="_blank" rel="noopener">原文链接</a></p><p>要跟上 JavaScript(ECMAScript) 更新的脚步很难，更难的是找到有用的代码示例。</p><p>因此，在本文中，我将介绍在 ES2016，ES2017 和 ES2018（最终草案）中添加的TC39已完成提案中列出的所有 18 个新特性，并一一展示有用的示例。</p><blockquote><p>这篇文章很长，不过应该很容易读，可以当成一篇“Netflix binge reading”。我保证你读完后将对这些新特性有很多的了解。</p></blockquote><p><strong>好，我们一个一个来看看。</strong></p><div class="post-button text-center"> <a class="btn" href="/2018/04/11/es2016-17-18/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/04/04/webkit-render/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/04/04/webkit-render/" itemprop="url">浏览器渲染引擎</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-04T00:00:00+00:00">2018-04-04</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">3,548</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>浏览器的内核中主要分为渲染引擎和 javascript 引擎，本篇主要围绕渲染引擎介绍一下浏览器的工作原理。</p><p>首先，我们先看几个 user-agent 的字符串：</p><ul><li>Mozilla/ 1.0 (Windows NT 6.1;rv:2.0.1) Gecko/2010010Firefox/4.0.1</li><li>Mozilla/ 4. 0 (compatible; MSIE 7. 0; Windows NT 6. 0)</li><li>Mozilla/ 5. 0 (Linux; Android4. 0. 4; Galaxy Nexus Build/ IMM76B) AppleWebKit/ 535. 19 (KHTML, like Gecko) Chrome/ 18. 0. 1025. 133 Mobile Safari/ 535.</li></ul><p>这是 3 个不同浏览器的 user-agent，第 1 个是 Firefox 的，第 2 个是 IE7 的，第 3 个是 Chrome 的。有没有觉得很奇怪，为什么所有字符串的前面都会有一个 Mozilla 开头呢？ 而且在 Chrome 中包含了很多其他浏览器的标识，Android，Gecko，Safari … , 这些浏览器厂商为什么要把这个 user-agent 字符串设计成这样？user-agent 按照正常的理解就是浏览器的标识，包含操作系统和浏览器信息带上版本号就行了，浏览器厂商为什么搞的这么复杂呢？</p><p>这需要了解一下 user-agent 字符串历史 ，大致的意思是， 早期的浏览器 Netscape 的 user-agent 是以 <code>Mozilla/Version [Language] (Platform; Encryption)</code> 的格式，大多数服务器在加载页面前都会检查 user-agent 是否为该款浏览器，然而在 1995 年， IE 发布首款浏览器，如果不兼容 Netscape user-agent 字串，用户就根本访问不了页面，于是 IE 就设计了这种格式： <code>Mozilla/2.0 (compatible; MSIE Version; Operating System)</code> 。 其他新的浏览器发布也是一样的，为了溶入主流而不被踢出局，在 user-agent 字串中放详尽的信息，以便骗取网站的信任使它与其它流行的浏览器兼容。</p><p>接下来，简单回顾一下浏览器的历史:</p><ul><li>WorldWideWeb 1991 年</li><li>Mosaic 1993 年</li><li>Netscape 1994 年</li><li>Opera 1995 年</li><li>IE 1995 年 一战</li><li>Safari 2003 年</li><li>Firefox 2004 年 二战</li><li>Chrome 2008 年</li><li>Edge 2015 年</li></ul><p>很多人都以为最早的浏览器是 Netscape， 其实在 Netscape 之前还有 WorldWideWeb 和 Mosaic 两个浏览器，WorldWideWeb 是世界上第一个浏览器，它同时也是一个编辑器，在 1991 年发布, 当时 http 的版本还是 0.9 ，只支持 get 请求。</p><p>随后在 1993 年 由美国伊利诺州的伊利诺大学的 NCSA 组织，发布第一个可以显示图片的浏览器，叫 Mosaic。随后 NCSA 将 Mosaic 的商业运营权转售给了 Spyglass 公司，该公司又向包括微软公司在内的多家公司技术授权，然后，微软的 IE 浏览器就是从这里开始了。<br>1994 年，在 Mosaic 浏览器开发团队的核心成员，重新成立 Netscape 公司，从此 Netscape 浏览器诞生。<br>1995 年，挪威的本土电信公司 Telenor 开发了一个新的浏览器 Opera，Opera 浏览器他特点就是速度快，但是兼容性不是很好，在浏览器上独创了很多功能，比如标签式浏览就是 Opera 发明的，Opera 在经历很多坎坷后，在 2016 年被奇虎 360 收购。<br>1995 同年，微软在取得 Spyglass Mosaic 的源代码和授权后，发布了首款浏览器 Internet Explorer ，从此展开浏览器第一次大战。<br>1998 年，Netscape 公司内部成立 Mozilla 组织。<br>2003 年，苹果公司发布了自己第一个浏览器 Safari，同时在两年后，也就是<br>2005 年开源了自己的浏览器内核 Webkit。<br>2004 年，Mozilla 组织发布了 Firefox 浏览器，然后第二次浏览器大战开始。<br>2008 年，是一个灾难很多的一年，四川大地震，过年回家又遇上雪灾，作为前端开发我的将要开始兼容一个由 Goolge 开发新的 Chrome 浏览器。 但是 Chrome 带来的体验是让人开心的 。<br>2015 年，微软随着 Windows 10 一起发布 Edge 浏览器，伤透大家心的 IE ，估计维护不下去。</p><p>当前市场浏览器市场占比最高的是 Chrome 浏览器，其次就是 IE，Firefox ，详细占比查看 Net Marketshare 的统计。</p><div class="post-button text-center"> <a class="btn" href="/2018/04/04/webkit-render/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.rsuitejs.com/2018/03/28/build-a-app-width-electron-and-react/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hypers"><meta itemprop="description" content=""><meta itemprop="image" content="/images/hypers_logo.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="HYPERS 前端团队博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/03/28/build-a-app-width-electron-and-react/" itemprop="url">如何使用 Electron 和 React 构建一个 APP</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-28T18:44:08+00:00">2018-03-28</time></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">2,744</span></div></div></header><div class="post-body" itemprop="articleBody"><p>这篇文章主要记录了，使用 Electron 构建的一个 APP 过程的关键步骤和遇到的问题及解决方法。</p><h1 id="最终成品效果图"><a href="#最终成品效果图" class="headerlink" title="最终成品效果图"></a>最终成品效果图</h1><img src="/2018/03/28/build-a-app-width-electron-and-react/electron-preview.gif" title="最终效果图"><p><a href="https://github.com/hiyangguo/bt-radish-app" target="_blank" rel="noopener">查看源码</a></p><div class="post-button text-center"> <a class="btn" href="/2018/03/28/build-a-app-width-electron-and-react/#more" rel="contents">阅读全文 &raquo;</a></div></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></section><nav class="pagination"> <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/hypers_logo.png" alt="Hypers"><p class="site-author-name" itemprop="name">Hypers</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">24</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">2</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">45</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2019</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Hypers</span> <span class="post-count">- 全站共56.0k字</span></div><div class="powered-by"> 由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info"> 主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script></body></html>